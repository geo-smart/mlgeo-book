
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>2.12 Dimensionality Reduction &#8212; ML Geo Curriculum</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.13 ML-ready data" href="2.13_MLready_data.html" />
    <link rel="prev" title="2.11 Feature Engineering" href="2.11_feature_engineering.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/GeoSMART_logo.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">ML Geo Curriculum</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../about_this_book/about_this_book.html">
                    Machine Learning in the Geosciences
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  About this Book
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://geo-smart.github.io/index.html">
   Geosmart website
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../about_this_book/acknowledgements.html">
   Acknowlegments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../about_this_book/0_mlgeo_project.html">
   Primer
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapter 1 - Open Source Ecosystem with Python
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter1-GettingStarted/readme.html">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter1-GettingStarted/1.1_open_reproducible_science.html">
   1.1 Open Reproducible Science
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter1-GettingStarted/1.2_jupyter_environment.html">
   1.3 Jupyter Environment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter1-GettingStarted/1.3_python_environment.html">
   1.3 Python Ecosystem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter1-GettingStarted/1.4_computational_environments.html">
   1.4 Computing Environments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter1-GettingStarted/1.5_version_control_git.html">
   1.5 Version Control &amp; GitHub
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter1-GettingStarted/1.6_data_gallery.html">
   1.6 Data Gallery
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter1-GettingStarted/1.20_MLGEO_Final_Project.html">
   Final Integrated Project in Machine Learning in Geoscience
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapter 2 - Data Manipulation
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="2.1_Data_Definitions.html">
   2.1 Data Definitions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2.2_data_formats_rendered.html">
   2.2 Data Formats
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2.3_pandas_rendered.html">
   2.3 Pandas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2.4_dataframes_prep.html">
   2.4 DataFrame Exploration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2.5_Arrays.html">
   2.5 Data Arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2.6_resampling.html">
   2.6 Resampling Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2.7_statistical_considerations.html">
   2.7 Statistical Considerations for geoscientific Data and Noise
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2.8_data_spectral_transforms.html">
   2.8 Spectral Transforms
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2.9_filtering_data.html">
   2.9 Filtering Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2.10_synthetic_noise.html">
   2.10 Synthetic noise
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2.11_feature_engineering.html">
   2.11 Feature Engineering
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   2.12 Dimensionality Reduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2.13_MLready_data.html">
   2.13 ML-ready data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2.20_Final_Project_Assignement.html">
   Assignment:
   <strong>
    Preparing AI-Ready Data for The Final Project
   </strong>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapter 3 - Machine Learning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter3-MachineLearning/3.1_concepts_supervision.html">
   3.1 Concepts in training supervision
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter3-MachineLearning/3.2_classification_regression.html">
   3.2 Classification and Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter3-MachineLearning/3.3_clustering.html">
   3.3 Clustering: Unsupervied Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter3-MachineLearning/3.4_binary_classification.html">
   3.4 Binary classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter3-MachineLearning/3.5_multiclass_classification.html">
   3.5 Multiclass Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter3-MachineLearning/3.6_logistic_regression.html">
   3.6 Logistic regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter3-MachineLearning/3.7_randomForest_regression.html">
   3.7 Random Forests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter3-MachineLearning/3.8_robust_training.html">
   3.8 Robust Training
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter3-MachineLearning/3.9_ensemble_learning.html">
   3.9 Ensemble learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter3-MachineLearning/3.10_autoML.html">
   3.10 AutoML
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter3-MachineLearning/3.20_final_project_cml.html">
   3.20 Final Project - Classic Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter3-MachineLearning/Homework_CML.html">
   Homework Classic Machine Learning (50 points)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapter 4 - Deep Learning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter4-DeepLearning/mlgeo_4.0_perceptrons.html">
   4.0 The Perceptron
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter4-DeepLearning/mlgeo_4.1_NN.html">
   4.1 Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter4-DeepLearning/mlgeo_4.2_MLP.html">
   4.2 Multi Layer Perceptrons
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter4-DeepLearning/mlgeo_4.3_CNN.html">
   4.3 Convolutional Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter4-DeepLearning/mlgeo_4.4_RNN.html">
   4.4  Recurrent Neural Networks: Processing sequences
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter4-DeepLearning/mlgeo_4.5_ModelTraining.html">
   4.5 Model Training
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter4-DeepLearning/mlgeo_4.6_AutoEncoder.html">
   4.6 Auto-encoders
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter4-DeepLearning/mlgeo_4.7_PINN.html">
   4.7 Physics-Informed Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter4-DeepLearning/mlgeo_4.8_NAS.html">
   4.8 NAS: Network Architecture Search
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter4-DeepLearning/mlgeo_4.20_final_project_assignement.html">
   Deep Learning Exploration with AI-Ready Datasets
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapter 5 - Workflow Management and Reproducibility
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter5-ModelWorkflows/readme.html">
   This chapter focuces on model workflow and ML reproducibility
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapter 6- Introduction to Cloud Computing
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/cloudmaven">
   Browser Access to Cloud Instances
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/Denolle-Lab/azure">
   Terraform Access to Cloud Instances
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://tljh.jupyter.org/en/latest/">
   Cloud Provider ML Jupyterhubs
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Reference
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../reference/glossary.html">
   Glossaries
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../reference/bibliography.html">
   Bibliography
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/geo-smart/mlgeo-book/main?urlpath=lab/tree/book/Chapter2-DataManipulation/2.12_dimensionality_reduction.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/geo-smart/mlgeo-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/geo-smart/mlgeo-book/issues/new?title=Issue%20on%20page%20%2FChapter2-DataManipulation/2.12_dimensionality_reduction.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/geo-smart/mlgeo-book/edit/main/book/Chapter2-DataManipulation/2.12_dimensionality_reduction.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/Chapter2-DataManipulation/2.12_dimensionality_reduction.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#feature-selection">
   1. Feature selection
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#feature-extraction">
   2. Feature extraction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#principal-component-analysis">
   3 Principal Component Analysis
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-1-subtract-the-mean">
     <em>
      Step 1
     </em>
     : subtract the mean
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-2-determine-the-svd-of-the-covariance-matrix">
     <em>
      Step 2
     </em>
     : Determine the SVD of the covariance matrix
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-3-explore-the-outcomes">
     <em>
      Step 3
     </em>
     : explore the outcomes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pca-on-climate-data">
     3.2 PCA on Climate Data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pca-on-geospatial-and-temporal-data">
     3.3 PCA on geospatial and temporal data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pca">
     PCA
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#correlation-structure-in-geospatial-temporal-data">
     1.
     <strong>
      Correlation Structure in Geospatial-Temporal Data
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mixing-of-spatial-and-temporal-variance">
     2.
     <strong>
      Mixing of Spatial and Temporal Variance
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dominance-of-global-trends">
     3.
     <strong>
      Dominance of Global Trends
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#temporal-non-stationarity">
     4.
     <strong>
      Temporal Non-stationarity
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sensitivity-to-data-preprocessing">
     5.
     <strong>
      Sensitivity to Data Preprocessing
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dimensionality-challenges">
     6.
     <strong>
      Dimensionality Challenges
     </strong>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#independent-component-analysis">
   4. Independent Component Analysis
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#key-differences-between-ica-and-pca">
     Key Differences Between ICA and PCA:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#advantages-of-ica-in-geosciences">
     Advantages of ICA in Geosciences:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#other-techniques">
   6. Other Techniques
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>2.12 Dimensionality Reduction</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#feature-selection">
   1. Feature selection
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#feature-extraction">
   2. Feature extraction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#principal-component-analysis">
   3 Principal Component Analysis
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-1-subtract-the-mean">
     <em>
      Step 1
     </em>
     : subtract the mean
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-2-determine-the-svd-of-the-covariance-matrix">
     <em>
      Step 2
     </em>
     : Determine the SVD of the covariance matrix
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-3-explore-the-outcomes">
     <em>
      Step 3
     </em>
     : explore the outcomes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pca-on-climate-data">
     3.2 PCA on Climate Data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pca-on-geospatial-and-temporal-data">
     3.3 PCA on geospatial and temporal data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pca">
     PCA
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#correlation-structure-in-geospatial-temporal-data">
     1.
     <strong>
      Correlation Structure in Geospatial-Temporal Data
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mixing-of-spatial-and-temporal-variance">
     2.
     <strong>
      Mixing of Spatial and Temporal Variance
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dominance-of-global-trends">
     3.
     <strong>
      Dominance of Global Trends
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#temporal-non-stationarity">
     4.
     <strong>
      Temporal Non-stationarity
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sensitivity-to-data-preprocessing">
     5.
     <strong>
      Sensitivity to Data Preprocessing
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dimensionality-challenges">
     6.
     <strong>
      Dimensionality Challenges
     </strong>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#independent-component-analysis">
   4. Independent Component Analysis
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#key-differences-between-ica-and-pca">
     Key Differences Between ICA and PCA:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#advantages-of-ica-in-geosciences">
     Advantages of ICA in Geosciences:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#other-techniques">
   6. Other Techniques
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="dimensionality-reduction">
<h1>2.12 Dimensionality Reduction<a class="headerlink" href="#dimensionality-reduction" title="Permalink to this headline">#</a></h1>
<p>Ideally, one would not need to extract or select features in the input data. However, reducing the dimensionality as a separate pre-processing step may be advantageous:</p>
<ol class="simple">
<li><p>The complexity of the algorithm depends on the number of input dimensions and size of the data.</p></li>
<li><p>If some features are unecessary, not extracting them saves computing time</p></li>
<li><p>Simpler models are more robust on small datasets</p></li>
<li><p>Fewer features lead to a better understanding of the data.</p></li>
<li><p>Visualization is easier in fewer dimensions.</p></li>
</ol>
<p>Dimensionality reduction techniques fall into two categories:</p>
<section id="feature-selection">
<h2>1. Feature selection<a class="headerlink" href="#feature-selection" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><strong>Feature <em>selection</em></strong> finds the dimensions that explain the data without loss of information and ends with a smaller dimensionality of the input data. A <em>forward selection</em> approach starts with one variable that decreases the error the most and adds one by one. A <em>backward selection</em> starts with all variables and removes them one by one.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import useful modules</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate synthetic climate data</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># For reproducibility</span>

<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">temperature</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n_samples</span><span class="p">)</span>  <span class="c1"># Mean 15°C, std 10°C</span>
<span class="n">humidity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n_samples</span><span class="p">)</span>     <span class="c1"># Mean 75%, std 15%</span>
<span class="c1"># Introduce correlation: precipitation is a function of humidity plus some noise</span>
<span class="n">precipitation</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">humidity</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n_samples</span><span class="p">)</span>  <span class="c1"># Correlated with humidity</span>
<span class="n">wind_speed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n_samples</span><span class="p">)</span>    <span class="c1"># Mean 10m/s, std 5m/s</span>
<span class="c1"># Introduce correlation: solar radiation is a function of temperature plus some noise</span>
<span class="n">solar_radiation</span> <span class="o">=</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="n">temperature</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n_samples</span><span class="p">)</span>  <span class="c1"># Correlated with temperature</span>

<span class="c1"># Combine into a DataFrame</span>
<span class="n">climate_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Temperature (°C)&#39;</span><span class="p">:</span> <span class="n">temperature</span><span class="p">,</span>
    <span class="s1">&#39;Humidity (%)&#39;</span><span class="p">:</span> <span class="n">humidity</span><span class="p">,</span>
    <span class="s1">&#39;Precipitation (mm)&#39;</span><span class="p">:</span> <span class="n">precipitation</span><span class="p">,</span>
    <span class="s1">&#39;Wind Speed (m/s)&#39;</span><span class="p">:</span> <span class="n">wind_speed</span><span class="p">,</span>
    <span class="s1">&#39;Solar Radiation (W/m2)&#39;</span><span class="p">:</span> <span class="n">solar_radiation</span>
<span class="p">})</span>
<span class="n">climate_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Temperature (°C)</th>
      <th>Humidity (%)</th>
      <th>Precipitation (mm)</th>
      <th>Wind Speed (m/s)</th>
      <th>Solar Radiation (W/m2)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>19.967142</td>
      <td>95.990332</td>
      <td>41.243383</td>
      <td>0.460962</td>
      <td>11.656245</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13.617357</td>
      <td>88.869505</td>
      <td>42.989566</td>
      <td>5.698075</td>
      <td>10.737868</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21.476885</td>
      <td>75.894456</td>
      <td>30.023029</td>
      <td>7.931972</td>
      <td>17.271593</td>
    </tr>
    <tr>
      <th>3</th>
      <td>30.230299</td>
      <td>65.295948</td>
      <td>29.568359</td>
      <td>19.438438</td>
      <td>26.547391</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12.658466</td>
      <td>85.473350</td>
      <td>23.800528</td>
      <td>12.782766</td>
      <td>3.292481</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the correlation matrix</span>
<span class="n">correlation_matrix</span> <span class="o">=</span> <span class="n">climate_data</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>

<span class="c1"># Display the correlation matrix with a color gradient</span>
<span class="n">correlation_matrix</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">background_gradient</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_03d39_row0_col0, #T_03d39_row1_col1, #T_03d39_row2_col2, #T_03d39_row3_col3, #T_03d39_row4_col4 {
  background-color: #b40426;
  color: #f1f1f1;
}
#T_03d39_row0_col1 {
  background-color: #3e51c5;
  color: #f1f1f1;
}
#T_03d39_row0_col2, #T_03d39_row4_col1 {
  background-color: #3d50c3;
  color: #f1f1f1;
}
#T_03d39_row0_col3, #T_03d39_row3_col4 {
  background-color: #465ecf;
  color: #f1f1f1;
}
#T_03d39_row0_col4, #T_03d39_row4_col0 {
  background-color: #e46e56;
  color: #f1f1f1;
}
#T_03d39_row1_col0, #T_03d39_row1_col3, #T_03d39_row1_col4, #T_03d39_row3_col1, #T_03d39_row3_col2 {
  background-color: #3b4cc0;
  color: #f1f1f1;
}
#T_03d39_row1_col2 {
  background-color: #f2c9b4;
  color: #000000;
}
#T_03d39_row2_col0 {
  background-color: #445acc;
  color: #f1f1f1;
}
#T_03d39_row2_col1 {
  background-color: #f4c6af;
  color: #000000;
}
#T_03d39_row2_col3 {
  background-color: #455cce;
  color: #f1f1f1;
}
#T_03d39_row2_col4 {
  background-color: #485fd1;
  color: #f1f1f1;
}
#T_03d39_row3_col0 {
  background-color: #4257c9;
  color: #f1f1f1;
}
#T_03d39_row4_col2 {
  background-color: #3f53c6;
  color: #f1f1f1;
}
#T_03d39_row4_col3 {
  background-color: #4a63d3;
  color: #f1f1f1;
}
</style>
<table id="T_03d39">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_03d39_level0_col0" class="col_heading level0 col0" >Temperature (°C)</th>
      <th id="T_03d39_level0_col1" class="col_heading level0 col1" >Humidity (%)</th>
      <th id="T_03d39_level0_col2" class="col_heading level0 col2" >Precipitation (mm)</th>
      <th id="T_03d39_level0_col3" class="col_heading level0 col3" >Wind Speed (m/s)</th>
      <th id="T_03d39_level0_col4" class="col_heading level0 col4" >Solar Radiation (W/m2)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_03d39_level0_row0" class="row_heading level0 row0" >Temperature (°C)</th>
      <td id="T_03d39_row0_col0" class="data row0 col0" >1.000000</td>
      <td id="T_03d39_row0_col1" class="data row0 col1" >-0.040400</td>
      <td id="T_03d39_row0_col2" class="data row0 col2" >-0.006884</td>
      <td id="T_03d39_row0_col3" class="data row0 col3" >-0.013321</td>
      <td id="T_03d39_row0_col4" class="data row0 col4" >0.840024</td>
    </tr>
    <tr>
      <th id="T_03d39_level0_row1" class="row_heading level0 row1" >Humidity (%)</th>
      <td id="T_03d39_row1_col0" class="data row1 col0" >-0.040400</td>
      <td id="T_03d39_row1_col1" class="data row1 col1" >1.000000</td>
      <td id="T_03d39_row1_col2" class="data row1 col2" >0.599756</td>
      <td id="T_03d39_row1_col3" class="data row1 col3" >-0.054698</td>
      <td id="T_03d39_row1_col4" class="data row1 col4" >-0.044765</td>
    </tr>
    <tr>
      <th id="T_03d39_level0_row2" class="row_heading level0 row2" >Precipitation (mm)</th>
      <td id="T_03d39_row2_col0" class="data row2 col0" >-0.006884</td>
      <td id="T_03d39_row2_col1" class="data row2 col1" >0.599756</td>
      <td id="T_03d39_row2_col2" class="data row2 col2" >1.000000</td>
      <td id="T_03d39_row2_col3" class="data row2 col3" >-0.016022</td>
      <td id="T_03d39_row2_col4" class="data row2 col4" >0.003570</td>
    </tr>
    <tr>
      <th id="T_03d39_level0_row3" class="row_heading level0 row3" >Wind Speed (m/s)</th>
      <td id="T_03d39_row3_col0" class="data row3 col0" >-0.013321</td>
      <td id="T_03d39_row3_col1" class="data row3 col1" >-0.054698</td>
      <td id="T_03d39_row3_col2" class="data row3 col2" >-0.016022</td>
      <td id="T_03d39_row3_col3" class="data row3 col3" >1.000000</td>
      <td id="T_03d39_row3_col4" class="data row3 col4" >-0.000992</td>
    </tr>
    <tr>
      <th id="T_03d39_level0_row4" class="row_heading level0 row4" >Solar Radiation (W/m2)</th>
      <td id="T_03d39_row4_col0" class="data row4 col0" >0.840024</td>
      <td id="T_03d39_row4_col1" class="data row4 col1" >-0.044765</td>
      <td id="T_03d39_row4_col2" class="data row4 col2" >0.003570</td>
      <td id="T_03d39_row4_col3" class="data row4 col3" >-0.000992</td>
      <td id="T_03d39_row4_col4" class="data row4 col4" >1.000000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Which feature might we remove given these correlations?</p>
</section>
<section id="feature-extraction">
<h2>2. Feature extraction<a class="headerlink" href="#feature-extraction" title="Permalink to this headline">#</a></h2>
<p><strong>Feature <em>extraction</em></strong> finds a new set of dimensions as a combination of the original dimensions. They can be supervised or unsupervised depending on the output information. Examples are <strong>Principal Component Analysis</strong>, <strong>Independent Component Analysis</strong> <strong>Linear Discriminant Analysis</strong></p>
</section>
<section id="principal-component-analysis">
<h2>3 Principal Component Analysis<a class="headerlink" href="#principal-component-analysis" title="Permalink to this headline">#</a></h2>
<p>PCA is an unsupervised learning method that finds the mapping from the input to a lower dimensional space with minimum loss of information.</p>
<p>Principal Component Analysis (<strong>PCA</strong>) identifies the axis that accounts for the largest amount of variance in the data.</p>
<p>Let: <span class="math notranslate nohighlight">\(\mathbf{Y} = \mathbf{y}_1,\cdots,\mathbf{y}_n \)</span> be the data, measured <span class="math notranslate nohighlight">\(n\)</span> times over multiple fields of measurements (the length of <span class="math notranslate nohighlight">\(\mathbf{y})\)</span>.</p>
<p>Each <strong>column</strong> of <span class="math notranslate nohighlight">\(\mathbf{Y}\)</span> represents a unique observation. Each <strong>row</strong> of <span class="math notranslate nohighlight">\( \mathbf{Y} \)</span> represents a single parameter.</p>
<p>To undertake PCA, we will</p>
<ol class="simple">
<li><p>Center and standardize the data by subtracting the mean of each row of <span class="math notranslate nohighlight">\(\mathbf{Y} \)</span>.</p></li>
<li><p>Calculate the covariance matrix of the de-meaned data <span class="math notranslate nohighlight">\(\mathbf{C}  =  \frac{1}{n-1} \mathbf{Y}^{\ast}\mathbf{Y}\)</span>. By definition, the covariance matrix is positive symmetric, and thus can be diagonalized.</p></li>
<li><p>Calculate the <em>Singular Value Decomposition (SVD)</em> of the covariance matrix <span class="math notranslate nohighlight">\(\mathbf{C} \)</span>.</p></li>
</ol>
<p>As the name implies, SVD decomposes the data covariance matrix <span class="math notranslate nohighlight">\(\mathbf{C} \)</span> into 3 terms:</p>
<p><span class="math notranslate nohighlight">\(\mathbf{X} = \mathbf{U} \Sigma \mathbf{V}^T ,\)</span></p>
<p>where <span class="math notranslate nohighlight">\(\mathbf{V}^T\)</span> contains the eigenvectors, or principal components.</p>
<p>Principal components are normalized, centered around zero.</p>
<p>The <em>1st principal component</em> eigenvector has the highest eigenvalue in the direction that has the highest variance.</p>
<p>To demonstrate the application of PCA, we will start with some toy data: a two-dimensional (2D) point cloud made up of 10,000 observations, each with two parameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generating the toy data</span>
<span class="n">xC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>      <span class="c1"># Center of data (mean)</span>
<span class="n">sig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>   <span class="c1"># Principal axes</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span>            <span class="c1"># Rotate cloud by pi/3</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)],</span>     <span class="c1"># Rotation matrix</span>
              <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)]])</span>
<span class="n">nPoints</span> <span class="o">=</span> <span class="mi">10000</span>            <span class="c1"># Create 10,000 points</span>

<span class="c1"># create the cloud of points by multiplying (np.matmul is also called by @)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">R</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">nPoints</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">xC</span><span class="p">)</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="n">nPoints</span><span class="p">))</span>
<span class="c1"># plot the data</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.125</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2.12_dimensionality_reduction_8_0.png" src="../_images/2.12_dimensionality_reduction_8_0.png" />
</div>
</div>
<section id="step-1-subtract-the-mean">
<h3><em>Step 1</em>: subtract the mean<a class="headerlink" href="#step-1-subtract-the-mean" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Remove the mean of the data</span>
<span class="n">Xavg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>                 <span class="c1"># Compute mean</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">X</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">Xavg</span><span class="p">,(</span><span class="n">nPoints</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>       <span class="c1"># Mean-subtracted data</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">B</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.125</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x153759850&gt;
</pre></div>
</div>
<img alt="../_images/2.12_dimensionality_reduction_10_1.png" src="../_images/2.12_dimensionality_reduction_10_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate the covariance matrix using matmul</span>
<span class="n">covB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="n">B</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="n">nPoints</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;shape of B </span><span class="si">{</span><span class="n">B</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> and shape of covB </span><span class="si">{</span><span class="n">covB</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">covB</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>shape of B (2, 10000) and shape of covB (2, 2)
[[1.19259352 1.64014365]
 [1.64014365 3.09080537]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-2-determine-the-svd-of-the-covariance-matrix">
<h3><em>Step 2</em>: Determine the SVD of the covariance matrix<a class="headerlink" href="#step-2-determine-the-svd-of-the-covariance-matrix" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find principal components (SVD): </span>
<span class="c1"># use the option full_matrices =0 will calculate the covariance of B</span>
<span class="c1"># Here, we transpose B so that each observation is on a row</span>

<span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">VT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">covB</span><span class="p">,</span><span class="n">full_matrices</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[4.0366594 , 0.        ],
       [0.        , 0.24673948]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">VT</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-0.4995708 , -0.86627306],
       [-0.86627306,  0.4995708 ]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-3-explore-the-outcomes">
<h3><em>Step 3</em>: explore the outcomes<a class="headerlink" href="#step-3-explore-the-outcomes" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.125</span><span class="p">)</span>   <span class="c1"># Plot data to overlay PCA</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="c1"># Plot eigenvectors VT[:,0] and VT[:,1]</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Xavg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Xavg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">VT</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]]),</span>
         <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Xavg</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Xavg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">VT</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]]),</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Xavg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Xavg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">VT</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]),</span>
         <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Xavg</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Xavg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">VT</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]]),</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1"># Plot eigenvectors VT[:,0] and VT[:,1]</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Xavg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Xavg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">VT</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">]]),</span>
         <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Xavg</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Xavg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">VT</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">]]),</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Xavg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Xavg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">VT</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">]]),</span>
         <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Xavg</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Xavg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">VT</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">]]),</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2.12_dimensionality_reduction_17_0.png" src="../_images/2.12_dimensionality_reduction_17_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let us project the original data</span>
<span class="c1"># Projecting the data onto the right singular vectors</span>

<span class="n">projected</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">VT</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">projected</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">projected</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2.12_dimensionality_reduction_18_0.png" src="../_images/2.12_dimensionality_reduction_18_0.png" />
</div>
</div>
</section>
<section id="pca-on-climate-data">
<h3>3.2 PCA on Climate Data<a class="headerlink" href="#pca-on-climate-data" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">climate_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Temperature (°C)</th>
      <th>Humidity (%)</th>
      <th>Precipitation (mm)</th>
      <th>Wind Speed (m/s)</th>
      <th>Solar Radiation (W/m2)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>19.967142</td>
      <td>95.990332</td>
      <td>41.243383</td>
      <td>0.460962</td>
      <td>11.656245</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13.617357</td>
      <td>88.869505</td>
      <td>42.989566</td>
      <td>5.698075</td>
      <td>10.737868</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21.476885</td>
      <td>75.894456</td>
      <td>30.023029</td>
      <td>7.931972</td>
      <td>17.271593</td>
    </tr>
    <tr>
      <th>3</th>
      <td>30.230299</td>
      <td>65.295948</td>
      <td>29.568359</td>
      <td>19.438438</td>
      <td>26.547391</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12.658466</td>
      <td>85.473350</td>
      <td>23.800528</td>
      <td>12.782766</td>
      <td>3.292481</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">climate_data_scaled</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1000, 5)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">climate_pca</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.1040393 , -1.31195709],
       [-0.36471427, -0.903754  ],
       [ 0.92535981,  0.28148253],
       ...,
       [ 2.32755929,  1.3884194 ],
       [-0.43357006,  0.29246707],
       [ 0.60857732,  0.96030444]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>

<span class="c1"># Standardize the data before applying PCA</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">climate_data_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">climate_data</span><span class="p">)</span>
<span class="c1"># Apply PCA</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Reduce to 2 dimensions for visualization</span>
<span class="n">climate_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">climate_data_scaled</span><span class="p">)</span>

<span class="c1"># Display the explained variance ratio</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Explained variance ratio:&quot;</span><span class="p">,</span> <span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">)</span>

<span class="c1"># Plot the PCA results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">climate_pca</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">climate_pca</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Principal Component 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Principal Component 2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PCA of Climate Data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Explained variance ratio: [0.36980642 0.31925119]
</pre></div>
</div>
<img alt="../_images/2.12_dimensionality_reduction_23_1.png" src="../_images/2.12_dimensionality_reduction_23_1.png" />
</div>
</div>
<p><em>SVD</em> can be computationally intensive for larger dimensions.</p>
<p>It is recommended to use a <strong>randomized PCA</strong> to approximate the first principal components. Scikit-learn automatically switches to randomized PCA in either the following happens: data size &gt; 500, number of vectors is &gt; 500 and the number of PCs selected is less than 80% of either one.</p>
</section>
<section id="pca-on-geospatial-and-temporal-data">
<h3>3.3 PCA on geospatial and temporal data<a class="headerlink" href="#pca-on-geospatial-and-temporal-data" title="Permalink to this headline">#</a></h3>
<p>Principal Component Analysis (PCA) to spatial-temporal datasets yields 2 important dimensions:</p>
<ul class="simple">
<li><p><strong>Empirical Orthogonal Functions</strong>:
EOFs are the eigenvectors obtained from the covariance matrix of the dataset. Each EOF corresponds to a spatial pattern that explains a portion of the total variance in the data. In climate science, EOFs help identify dominant patterns like atmospheric circulation modes or temperature anomalies.</p></li>
<li><p><strong>Principal Components (PCs)</strong>:
The time series associated with each EOF is called a principal component. PCs show how the amplitude of the corresponding EOF varies over time.</p></li>
</ul>
<p>Together, EOFs and PCs describe the spatial-temporal variability of the dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>

<span class="c1"># Step 1: Define the spatial grid</span>
<span class="n">lat_points</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">lon_points</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">latitudes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">lat_points</span><span class="p">)</span>  <span class="c1"># From South Pole to North Pole</span>
<span class="n">longitudes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="n">lon_points</span><span class="p">)</span>  <span class="c1"># Full range of longitudes</span>

<span class="c1"># Create a meshgrid for latitude and longitude</span>
<span class="n">lon_grid</span><span class="p">,</span> <span class="n">lat_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">longitudes</span><span class="p">,</span> <span class="n">latitudes</span><span class="p">)</span>

<span class="c1"># Step 2: Generate the latitudinal temperature gradient</span>
<span class="c1"># Assume temperatures decrease linearly from the equator to the poles</span>
<span class="n">latitudinal_gradient</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lat_grid</span><span class="p">))</span>  <span class="c1"># Cosine function for smooth transition</span>
<span class="n">latitudinal_gradient</span> <span class="o">=</span> <span class="n">latitudinal_gradient</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">latitudinal_gradient</span><span class="p">)</span>  <span class="c1"># Normalize</span>


<span class="c1"># Step 3: Generate the seasonal cycle</span>
<span class="n">time_steps</span> <span class="o">=</span> <span class="mi">360</span>  <span class="c1"># 30 years of monthly data</span>
<span class="n">months</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">time_steps</span><span class="p">)</span> <span class="o">%</span> <span class="mi">12</span>  <span class="c1"># Months from 0 to 11</span>
<span class="n">seasonal_cycle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">months</span> <span class="o">/</span> <span class="mi">12</span><span class="p">)</span>  <span class="c1"># 12-month cycle</span>


<span class="c1"># Step 4: Introduce a climate trend</span>
<span class="c1"># Simulate a small temperature increase over 30 years</span>
<span class="n">trend</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">time_steps</span><span class="p">)</span>  <span class="c1"># Temperature increases by 0.5 units over 30 years</span>

<span class="c1"># Step 5: Combine latitudinal gradient and seasonal cycle</span>
<span class="c1"># Initialize the data array</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">time_steps</span><span class="p">,</span> <span class="n">lat_points</span><span class="p">,</span> <span class="n">lon_points</span><span class="p">))</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">time_steps</span><span class="p">):</span>
    <span class="c1"># Temperature at each time step is the product of latitudinal gradient and seasonal cycle</span>
    <span class="n">data</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">latitudinal_gradient</span> <span class="o">*</span> <span class="n">seasonal_cycle</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">trend</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>

<span class="c1"># Step 6: Add random noise to simulate variability</span>
<span class="n">noise_level</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># Adjust the noise level as needed</span>
<span class="n">random_noise</span> <span class="o">=</span> <span class="n">noise_level</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">time_steps</span><span class="p">,</span> <span class="n">lat_points</span><span class="p">,</span> <span class="n">lon_points</span><span class="p">)</span>
<span class="n">data</span> <span class="o">+=</span> <span class="n">random_noise</span>

<span class="c1"># Visualize the synthetic climate data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Synthetic Climate Data (Month 2)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Longitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Temperature&#39;</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1"># make the colorbar smaller</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2.12_dimensionality_reduction_25_0.png" src="../_images/2.12_dimensionality_reduction_25_0.png" />
</div>
</div>
</section>
<section id="pca">
<h3>PCA<a class="headerlink" href="#pca" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Step 7: Reshape data for PCA</span>
<span class="n">data_reshaped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">time_steps</span><span class="p">,</span> <span class="n">lat_points</span> <span class="o">*</span> <span class="n">lon_points</span><span class="p">)</span>

<span class="c1"># Step 8: Standardize the data</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">data_standardized</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data_reshaped</span><span class="p">)</span>

<span class="c1"># Step 9: Apply PCA</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">principal_components</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data_standardized</span><span class="p">)</span>

<span class="c1"># Step 10: Interpret Results</span>
<span class="c1"># Reshape the principal components back to spatial dimensions for plotting</span>
<span class="n">eofs</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">components_</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">lat_points</span><span class="p">,</span> <span class="n">lon_points</span><span class="p">)</span>

<span class="c1"># Plot the first EOF (Spatial Pattern)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">eofs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;First EOF - Spatial Pattern&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Longitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Plot the corresponding time series of the first principal component</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">principal_components</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;First Principal Component Time Series&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (Months)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Plot the second EOF (Spatial Pattern)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">eofs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Second EOF - Spatial Pattern&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Longitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Plot the corresponding time series of the second principal component</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">principal_components</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Second Principal Component Time Series&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (Months)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1"># Plot the third EOF (Spatial Pattern)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">eofs</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Third EOF - Spatial Pattern&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Longitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Plot the corresponding time series of the third principal component</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">principal_components</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Third Principal Component Time Series&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (Months)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1"># Explained variance ratios</span>
<span class="n">explained_variance</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Explained Variance Ratios:&quot;</span><span class="p">,</span> <span class="n">explained_variance</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2.12_dimensionality_reduction_27_0.png" src="../_images/2.12_dimensionality_reduction_27_0.png" />
<img alt="../_images/2.12_dimensionality_reduction_27_1.png" src="../_images/2.12_dimensionality_reduction_27_1.png" />
<img alt="../_images/2.12_dimensionality_reduction_27_2.png" src="../_images/2.12_dimensionality_reduction_27_2.png" />
<img alt="../_images/2.12_dimensionality_reduction_27_3.png" src="../_images/2.12_dimensionality_reduction_27_3.png" />
<img alt="../_images/2.12_dimensionality_reduction_27_4.png" src="../_images/2.12_dimensionality_reduction_27_4.png" />
<img alt="../_images/2.12_dimensionality_reduction_27_5.png" src="../_images/2.12_dimensionality_reduction_27_5.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Explained Variance Ratios: [0.72900329 0.04557341 0.00145263 0.00137667 0.00135938]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the scree plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">explained_variance</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Variance explained by each PC &#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Principal Component&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Explained Variance Ratio&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2.12_dimensionality_reduction_29_0.png" src="../_images/2.12_dimensionality_reduction_29_0.png" />
</div>
</div>
<p>It is noted here that there is no good separatation between the first two components. Here are some limitations in using PCA for geospatial-temporal data.</p>
</section>
<section id="correlation-structure-in-geospatial-temporal-data">
<h3>1. <strong>Correlation Structure in Geospatial-Temporal Data</strong><a class="headerlink" href="#correlation-structure-in-geospatial-temporal-data" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p><strong>Spatial and Temporal Autocorrelation</strong>: Geospatial data often exhibits strong spatial and temporal autocorrelation—nearby locations and consecutive time points tend to be similar. This can make it challenging for PCA to separate patterns, as <em><strong>PCA is based on the assumption that components are linearly uncorrelated</strong></em>. However, in geospatial-temporal data, the patterns are often interdependent, which can result in components that do not separate spatial and temporal influences cleanly.</p></li>
<li><p><strong>Smooth Transitions</strong>: Many geospatial-temporal processes (e.g., climate variables) change smoothly over space and time. These gradual transitions may not produce distinct, orthogonal components when applying PCA, as the variance is spread across broad regions or time spans rather than concentrated in distinct patterns.</p></li>
</ul>
</section>
<section id="mixing-of-spatial-and-temporal-variance">
<h3>2. <strong>Mixing of Spatial and Temporal Variance</strong><a class="headerlink" href="#mixing-of-spatial-and-temporal-variance" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p><strong>Spatial and Temporal Dynamics Interact</strong>: In geospatial-temporal datasets, spatial variability and temporal variability are often intertwined. For example, seasonal patterns might dominate both spatial and temporal dimensions, leading PCA to pick components that capture a mix of spatial and temporal variance, rather than separating them into different components. The result is components that may reflect a combination of both dimensions, but not in a way that provides clear separation.</p></li>
<li><p><strong>Complex, Non-linear Interactions</strong>: Many geospatial-temporal processes are driven by non-linear interactions (e.g., atmospheric processes, hydrology). PCA, being a linear method, is not well-suited to capturing non-linear relationships, leading to components that fail to distinguish between different driving forces of the variability.</p></li>
</ul>
</section>
<section id="dominance-of-global-trends">
<h3>3. <strong>Dominance of Global Trends</strong><a class="headerlink" href="#dominance-of-global-trends" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p><strong>Global Trends Overwhelm Local Variations</strong>: In geospatial-temporal data, large-scale trends (such as global warming, large climatic events) can dominate the variability, overwhelming more subtle, local patterns. PCA, which seeks to maximize the explained variance in the first few components, may focus on these global trends. As a result, the components may primarily reflect large-scale phenomena, leaving less variance to be explained by smaller, localized processes that are of interest.</p></li>
</ul>
</section>
<section id="temporal-non-stationarity">
<h3>4. <strong>Temporal Non-stationarity</strong><a class="headerlink" href="#temporal-non-stationarity" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p><strong>Changing Processes Over Time</strong>: In many geospatial-temporal datasets, the underlying processes are non-stationary, meaning the dominant patterns of variability change over time. PCA assumes that the variance structure is constant, which can lead to components that reflect averaged patterns over the entire dataset but fail to capture temporal shifts in dominant processes, making interpretation difficult.</p></li>
</ul>
</section>
<section id="sensitivity-to-data-preprocessing">
<h3>5. <strong>Sensitivity to Data Preprocessing</strong><a class="headerlink" href="#sensitivity-to-data-preprocessing" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p><strong>Scaling and Centering Issues</strong>: In geospatial-temporal data, variables often have different units, magnitudes, or scales (e.g., temperature, precipitation, vegetation indices). Proper scaling and centering of variables are crucial in PCA, but choosing an appropriate scaling method can be difficult when dealing with multiple variables or dimensions (e.g., space and time). Incorrect scaling can lead to overemphasis on one variable or dimension, causing poor separation of components.</p></li>
</ul>
</section>
<section id="dimensionality-challenges">
<h3>6. <strong>Dimensionality Challenges</strong><a class="headerlink" href="#dimensionality-challenges" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p><strong>High-Dimensional Data</strong>: Geospatial-temporal datasets often have a very high dimensionality, with many spatial points and time steps. In such cases, PCA can struggle because the variance is spread across many dimensions, leading to components that capture small amounts of variance and are difficult to interpret. This is often referred to as the “curse of dimensionality,” where the high number of variables makes it difficult to reduce the dataset to a small number of interpretable components.</p></li>
</ul>
</section>
</section>
<section id="independent-component-analysis">
<h2>4. Independent Component Analysis<a class="headerlink" href="#independent-component-analysis" title="Permalink to this headline">#</a></h2>
<p><strong>What is ICA and How Does It Differ from PCA?</strong>
Independent Component Analysis (ICA) is a computational method for separating a multivariate signal into additive, independent non-Gaussian components. It is a type of blind source separation technique.</p>
<section id="key-differences-between-ica-and-pca">
<h3>Key Differences Between ICA and PCA:<a class="headerlink" href="#key-differences-between-ica-and-pca" title="Permalink to this headline">#</a></h3>
<p>PCA: Finds orthogonal axes (principal components) that maximize the variance in the data.
ICA: Seeks statistically independent components, not necessarily orthogonal, by minimizing mutual information.
Assumptions:</p>
<p>PCA: Assumes that the data is linearly correlated and relies on second-order statistics (covariance).
ICA: Assumes that the underlying components are statistically independent and non-Gaussian.
Results:</p>
<p>PCA: Components are uncorrelated but may not be independent.
ICA: Components are both uncorrelated and independent, capturing more complex underlying structures.</p>
<p>ICA is used to estimate sources given noisy measurements. It is frequently used in Geodesy to isolate contributions from earthquakes and hydrology.</p>
</section>
<section id="advantages-of-ica-in-geosciences">
<h3>Advantages of ICA in Geosciences:<a class="headerlink" href="#advantages-of-ica-in-geosciences" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p><strong>Blind Source Separation</strong>: ICA can separate mixed signals into their original sources without prior knowledge, which is useful when the underlying processes are unknown.</p></li>
<li><p><strong>Non-Gaussian Signals</strong>: Many geophysical processes generate non-Gaussian data (e.g., precipitation events, seismic signals), where ICA can be more effective than PCA.</p></li>
<li><p><strong>Independent Components</strong>: Identifying independent factors can help in understanding and modeling complex geoscientific phenomena that are driven by multiple independent sources.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">FastICA</span>

<span class="c1"># Generate sample data</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">2000</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">)</span>

<span class="c1"># create 3 source signals</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">time</span><span class="p">)</span>  <span class="c1"># Signal 1 : sinusoidal signal</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">time</span><span class="p">))</span>  <span class="c1"># Signal 2 : square signal</span>
<span class="n">s3</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sawtooth</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">time</span><span class="p">)</span>  <span class="c1"># Signal 3: saw tooth signal</span>


<span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s3</span><span class="p">]</span>
<span class="n">S</span> <span class="o">+=</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">S</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># Add noise</span>
<span class="n">S</span> <span class="o">/=</span> <span class="n">S</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Standardize data</span>

<span class="nb">print</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 0.495126    0.07841108 -1.31840023]
 [ 0.64019598  1.34570272 -1.94657351]
 [ 0.28913069  0.9500949  -1.646886  ]
 ...
 [-0.38561943 -0.71624672  1.34043406]
 [-0.50777458 -1.24052539  1.74176784]
 [-0.5550078  -0.90265774 -1.54534953]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mix data</span>
<span class="c1"># create 3 signals at 3 receivers:</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]])</span>  <span class="c1"># Mixing matrix</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>  <span class="c1"># Generate observations</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;True Sources&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Mixed Signals&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2.12_dimensionality_reduction_34_0.png" src="../_images/2.12_dimensionality_reduction_34_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute ICA</span>
<span class="n">ica</span> <span class="o">=</span> <span class="n">FastICA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">S_</span> <span class="o">=</span> <span class="n">ica</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>  <span class="c1"># Reconstruct signals</span>
<span class="n">A_</span> <span class="o">=</span> <span class="n">ica</span><span class="o">.</span><span class="n">mixing_</span>  <span class="c1"># Get estimated mixing matrix</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A_</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># For comparison, compute PCA</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>  <span class="c1"># Reconstruct signals based on orthogonal components</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 1.01396018  1.02993002 -0.94915864]
 [ 1.9826966   0.98533885 -0.47232592]
 [ 0.99746591  2.05242661 -1.37841317]] [[1.  1.  1. ]
 [0.5 2.  1. ]
 [1.5 1.  2. ]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">models</span> <span class="o">=</span> <span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">S_</span><span class="p">,</span> <span class="n">H</span><span class="p">]</span>
<span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Observations (mixed signal)&#39;</span><span class="p">,</span>
         <span class="s1">&#39;True Sources&#39;</span><span class="p">,</span>
         <span class="s1">&#39;ICA recovered signals&#39;</span><span class="p">,</span> 
         <span class="s1">&#39;PCA recovered signals&#39;</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;steelblue&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">names</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ii</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">sig</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2.12_dimensionality_reduction_36_0.png" src="../_images/2.12_dimensionality_reduction_36_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">FastICA</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>

<span class="c1"># Step 8: Center and whiten the data</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">data_whitened</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data_reshaped</span><span class="p">)</span>

<span class="c1"># Step 9: Apply ICA</span>
<span class="n">n_components</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">ica</span> <span class="o">=</span> <span class="n">FastICA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_components</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">S_</span> <span class="o">=</span> <span class="n">ica</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data_whitened</span><span class="p">)</span>  <span class="c1"># Reconstructed signals</span>
<span class="n">A_</span> <span class="o">=</span> <span class="n">ica</span><span class="o">.</span><span class="n">mixing_</span>  <span class="c1"># Estimated mixing matrix</span>

<span class="c1"># Step 10: Reshape independent components for plotting</span>
<span class="n">ICs</span> <span class="o">=</span> <span class="n">A_</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_components</span><span class="p">,</span> <span class="n">lat_points</span><span class="p">,</span> <span class="n">lon_points</span><span class="p">)</span>

<span class="c1"># Step 11: Plot the independent components</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_components</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ICs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Independent Component </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1"> - Spatial Pattern&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Longitude&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">S_</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Independent Component </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1"> - Time Series&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (Months)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2.12_dimensionality_reduction_37_0.png" src="../_images/2.12_dimensionality_reduction_37_0.png" />
<img alt="../_images/2.12_dimensionality_reduction_37_1.png" src="../_images/2.12_dimensionality_reduction_37_1.png" />
<img alt="../_images/2.12_dimensionality_reduction_37_2.png" src="../_images/2.12_dimensionality_reduction_37_2.png" />
</div>
</div>
</section>
</section>
<section id="other-techniques">
<h2>6. Other Techniques<a class="headerlink" href="#other-techniques" title="Permalink to this headline">#</a></h2>
<ol class="simple">
<li><p>Random Projections
<a class="reference external" href="https://scikit-learn.org/stable/modules/random_projection.html">https://scikit-learn.org/stable/modules/random_projection.html</a></p></li>
<li><p>Multidimensional Scaling</p></li>
<li><p>Isomap</p></li>
<li><p>t-Distributed stochastic neighbor embedding</p></li>
<li><p>Linear discriminant analysis</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip install earthaccess
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting earthaccess
  Downloading earthaccess-0.11.0-py3-none-any.whl.metadata (7.0 kB)
Requirement already satisfied: fsspec&gt;=2022.11 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from earthaccess) (2024.9.0)
Collecting importlib-resources&gt;=6.3.2 (from earthaccess)
  Downloading importlib_resources-6.4.5-py3-none-any.whl.metadata (4.0 kB)
Collecting multimethod&gt;=1.8 (from earthaccess)
  Downloading multimethod-1.12-py3-none-any.whl.metadata (9.6 kB)
Requirement already satisfied: numpy&gt;=1.24.0 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from earthaccess) (1.26.0)
Collecting pqdm&gt;=0.1 (from earthaccess)
  Downloading pqdm-0.2.0-py2.py3-none-any.whl.metadata (3.2 kB)
Collecting python-cmr&gt;=0.10.0 (from earthaccess)
  Downloading python_cmr-0.13.0-py3-none-any.whl.metadata (10 kB)
Requirement already satisfied: requests&gt;=2.26 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from earthaccess) (2.31.0)
Requirement already satisfied: s3fs&gt;=2022.11 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from earthaccess) (2024.9.0)
Collecting tinynetrc&gt;=1.3.1 (from earthaccess)
  Downloading tinynetrc-1.3.1-py2.py3-none-any.whl.metadata (2.9 kB)
Collecting typing-extensions&gt;=4.10.0 (from earthaccess)
  Using cached typing_extensions-4.12.2-py3-none-any.whl.metadata (3.0 kB)
Requirement already satisfied: zipp&gt;=3.1.0 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from importlib-resources&gt;=6.3.2-&gt;earthaccess) (3.17.0)
Collecting bounded-pool-executor (from pqdm&gt;=0.1-&gt;earthaccess)
  Downloading bounded_pool_executor-0.0.3-py3-none-any.whl.metadata (2.7 kB)
Requirement already satisfied: tqdm in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from pqdm&gt;=0.1-&gt;earthaccess) (4.66.5)
Requirement already satisfied: python-dateutil&lt;3.0.0,&gt;=2.8.2 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from python-cmr&gt;=0.10.0-&gt;earthaccess) (2.8.2)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from requests&gt;=2.26-&gt;earthaccess) (3.3.0)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from requests&gt;=2.26-&gt;earthaccess) (3.4)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from requests&gt;=2.26-&gt;earthaccess) (1.26.20)
Requirement already satisfied: certifi&gt;=2017.4.17 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from requests&gt;=2.26-&gt;earthaccess) (2023.7.22)
Requirement already satisfied: aiobotocore&lt;3.0.0,&gt;=2.5.4 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from s3fs&gt;=2022.11-&gt;earthaccess) (2.15.1)
Requirement already satisfied: aiohttp!=4.0.0a0,!=4.0.0a1 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from s3fs&gt;=2022.11-&gt;earthaccess) (3.10.9)
Requirement already satisfied: botocore&lt;1.35.24,&gt;=1.35.16 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from aiobotocore&lt;3.0.0,&gt;=2.5.4-&gt;s3fs&gt;=2022.11-&gt;earthaccess) (1.35.23)
Requirement already satisfied: wrapt&lt;2.0.0,&gt;=1.10.10 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from aiobotocore&lt;3.0.0,&gt;=2.5.4-&gt;s3fs&gt;=2022.11-&gt;earthaccess) (1.15.0)
Requirement already satisfied: aioitertools&lt;1.0.0,&gt;=0.5.1 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from aiobotocore&lt;3.0.0,&gt;=2.5.4-&gt;s3fs&gt;=2022.11-&gt;earthaccess) (0.12.0)
Requirement already satisfied: aiohappyeyeballs&gt;=2.3.0 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1-&gt;s3fs&gt;=2022.11-&gt;earthaccess) (2.4.3)
Requirement already satisfied: aiosignal&gt;=1.1.2 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1-&gt;s3fs&gt;=2022.11-&gt;earthaccess) (1.3.1)
Requirement already satisfied: attrs&gt;=17.3.0 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1-&gt;s3fs&gt;=2022.11-&gt;earthaccess) (23.1.0)
Requirement already satisfied: frozenlist&gt;=1.1.1 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1-&gt;s3fs&gt;=2022.11-&gt;earthaccess) (1.4.0)
Requirement already satisfied: multidict&lt;7.0,&gt;=4.5 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1-&gt;s3fs&gt;=2022.11-&gt;earthaccess) (6.0.4)
Requirement already satisfied: yarl&lt;2.0,&gt;=1.12.0 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1-&gt;s3fs&gt;=2022.11-&gt;earthaccess) (1.13.1)
Requirement already satisfied: async-timeout&lt;5.0,&gt;=4.0 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1-&gt;s3fs&gt;=2022.11-&gt;earthaccess) (4.0.3)
Requirement already satisfied: six&gt;=1.5 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from python-dateutil&lt;3.0.0,&gt;=2.8.2-&gt;python-cmr&gt;=0.10.0-&gt;earthaccess) (1.16.0)
Requirement already satisfied: jmespath&lt;2.0.0,&gt;=0.7.1 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from botocore&lt;1.35.24,&gt;=1.35.16-&gt;aiobotocore&lt;3.0.0,&gt;=2.5.4-&gt;s3fs&gt;=2022.11-&gt;earthaccess) (1.0.1)
Downloading earthaccess-0.11.0-py3-none-any.whl (59 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">59.4/59.4 kB</span> <span class=" -Color -Color-Red">1.7 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading importlib_resources-6.4.5-py3-none-any.whl (36 kB)
Downloading multimethod-1.12-py3-none-any.whl (10 kB)
Downloading pqdm-0.2.0-py2.py3-none-any.whl (6.8 kB)
Downloading python_cmr-0.13.0-py3-none-any.whl (14 kB)
Downloading tinynetrc-1.3.1-py2.py3-none-any.whl (3.9 kB)
Using cached typing_extensions-4.12.2-py3-none-any.whl (37 kB)
Downloading bounded_pool_executor-0.0.3-py3-none-any.whl (3.4 kB)
Installing collected packages: tinynetrc, bounded-pool-executor, typing-extensions, multimethod, importlib-resources, python-cmr, pqdm, earthaccess
  Attempting uninstall: typing-extensions
    Found existing installation: typing_extensions 4.5.0
    Uninstalling typing_extensions-4.5.0:
      Successfully uninstalled typing_extensions-4.5.0
  Attempting uninstall: importlib-resources
    Found existing installation: importlib-resources 6.1.0
    Uninstalling importlib-resources-6.1.0:
      Successfully uninstalled importlib-resources-6.1.0
<span class=" -Color -Color-Red">ERROR: pip&#39;s dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.</span>
<span class=" -Color -Color-Red">tensorflow 2.12.1 requires typing-extensions&lt;4.6.0,&gt;=3.6.6, but you have typing-extensions 4.12.2 which is incompatible.</span>
Successfully installed bounded-pool-executor-0.0.3 earthaccess-0.11.0 importlib-resources-6.4.5 multimethod-1.12 pqdm-0.2.0 python-cmr-0.13.0 tinynetrc-1.3.1 typing-extensions-4.12.2

<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> A new release of pip is available: <span class=" -Color -Color-Red">23.3.1</span> -&gt; <span class=" -Color -Color-Green">24.2</span>
<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> To update, run: <span class=" -Color -Color-Green">pip install --upgrade pip</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip install <span class="s2">&quot;sliderule @ git+https://github.com/SlideRuleEarth/sliderule#subdirectory=clients/python&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting sliderule@ git+https://github.com/SlideRuleEarth/sliderule#subdirectory=clients/python
  Cloning https://github.com/SlideRuleEarth/sliderule to /private/var/folders/js/lzmy975n0l5bjbmr9db291m00000gn/T/pip-install-nbzikxge/sliderule_75a8f52e3d2a4c65b4d67ac42ee0abe3
  Running command git clone --filter=blob:none --quiet https://github.com/SlideRuleEarth/sliderule /private/var/folders/js/lzmy975n0l5bjbmr9db291m00000gn/T/pip-install-nbzikxge/sliderule_75a8f52e3d2a4c65b4d67ac42ee0abe3
  Resolved https://github.com/SlideRuleEarth/sliderule to commit 93fc823b661bf80e054a8c89c3e63ba14f1f8a35
  Preparing metadata (setup.py) ... ?25ldone
?25hRequirement already satisfied: requests in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from sliderule@ git+https://github.com/SlideRuleEarth/sliderule#subdirectory=clients/python) (2.31.0)
Requirement already satisfied: numpy in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from sliderule@ git+https://github.com/SlideRuleEarth/sliderule#subdirectory=clients/python) (1.26.0)
Requirement already satisfied: fiona in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from sliderule@ git+https://github.com/SlideRuleEarth/sliderule#subdirectory=clients/python) (1.9.4)
Requirement already satisfied: geopandas in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from sliderule@ git+https://github.com/SlideRuleEarth/sliderule#subdirectory=clients/python) (0.14.0)
Requirement already satisfied: shapely in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from sliderule@ git+https://github.com/SlideRuleEarth/sliderule#subdirectory=clients/python) (2.0.1)
Requirement already satisfied: scikit-learn in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from sliderule@ git+https://github.com/SlideRuleEarth/sliderule#subdirectory=clients/python) (1.3.1)
Requirement already satisfied: pyarrow in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from sliderule@ git+https://github.com/SlideRuleEarth/sliderule#subdirectory=clients/python) (12.0.1)
Requirement already satisfied: attrs&gt;=19.2.0 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from fiona-&gt;sliderule@ git+https://github.com/SlideRuleEarth/sliderule#subdirectory=clients/python) (23.1.0)
Requirement already satisfied: certifi in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from fiona-&gt;sliderule@ git+https://github.com/SlideRuleEarth/sliderule#subdirectory=clients/python) (2023.7.22)
Requirement already satisfied: click~=8.0 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from fiona-&gt;sliderule@ git+https://github.com/SlideRuleEarth/sliderule#subdirectory=clients/python) (8.1.7)
Requirement already satisfied: click-plugins&gt;=1.0 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from fiona-&gt;sliderule@ git+https://github.com/SlideRuleEarth/sliderule#subdirectory=clients/python) (1.1.1)
Requirement already satisfied: cligj&gt;=0.5 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from fiona-&gt;sliderule@ git+https://github.com/SlideRuleEarth/sliderule#subdirectory=clients/python) (0.7.2)
Requirement already satisfied: six in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from fiona-&gt;sliderule@ git+https://github.com/SlideRuleEarth/sliderule#subdirectory=clients/python) (1.16.0)
Requirement already satisfied: importlib-metadata in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from fiona-&gt;sliderule@ git+https://github.com/SlideRuleEarth/sliderule#subdirectory=clients/python) (6.8.0)
Requirement already satisfied: packaging in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from geopandas-&gt;sliderule@ git+https://github.com/SlideRuleEarth/sliderule#subdirectory=clients/python) (23.2)
Requirement already satisfied: pandas&gt;=1.4.0 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from geopandas-&gt;sliderule@ git+https://github.com/SlideRuleEarth/sliderule#subdirectory=clients/python) (2.1.1)
Requirement already satisfied: pyproj&gt;=3.3.0 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from geopandas-&gt;sliderule@ git+https://github.com/SlideRuleEarth/sliderule#subdirectory=clients/python) (3.6.1)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from requests-&gt;sliderule@ git+https://github.com/SlideRuleEarth/sliderule#subdirectory=clients/python) (3.3.0)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from requests-&gt;sliderule@ git+https://github.com/SlideRuleEarth/sliderule#subdirectory=clients/python) (3.4)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from requests-&gt;sliderule@ git+https://github.com/SlideRuleEarth/sliderule#subdirectory=clients/python) (1.26.20)
Requirement already satisfied: scipy&gt;=1.5.0 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from scikit-learn-&gt;sliderule@ git+https://github.com/SlideRuleEarth/sliderule#subdirectory=clients/python) (1.11.3)
Requirement already satisfied: joblib&gt;=1.1.1 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from scikit-learn-&gt;sliderule@ git+https://github.com/SlideRuleEarth/sliderule#subdirectory=clients/python) (1.3.2)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from scikit-learn-&gt;sliderule@ git+https://github.com/SlideRuleEarth/sliderule#subdirectory=clients/python) (3.2.0)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from pandas&gt;=1.4.0-&gt;geopandas-&gt;sliderule@ git+https://github.com/SlideRuleEarth/sliderule#subdirectory=clients/python) (2.8.2)
Requirement already satisfied: pytz&gt;=2020.1 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from pandas&gt;=1.4.0-&gt;geopandas-&gt;sliderule@ git+https://github.com/SlideRuleEarth/sliderule#subdirectory=clients/python) (2023.3.post1)
Requirement already satisfied: tzdata&gt;=2022.1 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from pandas&gt;=1.4.0-&gt;geopandas-&gt;sliderule@ git+https://github.com/SlideRuleEarth/sliderule#subdirectory=clients/python) (2023.3)
Requirement already satisfied: zipp&gt;=0.5 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from importlib-metadata-&gt;fiona-&gt;sliderule@ git+https://github.com/SlideRuleEarth/sliderule#subdirectory=clients/python) (3.17.0)
Building wheels for collected packages: sliderule
  Building wheel for sliderule (setup.py) ... ?25ldone
?25h  Created wheel for sliderule: filename=sliderule-4.8.3-py3-none-any.whl size=137059 sha256=c239c424ae8618de8637fb4d977ce8f5f76f946736ee3065978568ad4e396c72
  Stored in directory: /private/var/folders/js/lzmy975n0l5bjbmr9db291m00000gn/T/pip-ephem-wheel-cache-1umkice8/wheels/0e/05/25/54630cda2aa0bcc766bede5fcadf8fbd67ce1bb2681db5e16b
Successfully built sliderule
Installing collected packages: sliderule
Successfully installed sliderule-4.8.3

<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> A new release of pip is available: <span class=" -Color -Color-Red">23.3.1</span> -&gt; <span class=" -Color -Color-Green">24.2</span>
<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> To update, run: <span class=" -Color -Color-Green">pip install --upgrade pip</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sliderule</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">URL</span> <span class="o">=</span> <span class="s1">&#39;https://data.gesdisc.earthdata.nasa.gov/data/MERRA2/M2T1NXSLV.5.12.4/1980/01/MERRA2_100.tavg1_2d_slv_Nx.19800101.nc4&#39;</span>

<span class="c1"># Set the FILENAME string to the data file name, the LABEL keyword value, or any customized name. </span>
<span class="c1"># Remember to include the same file extension as in the URL.</span>
<span class="n">FILENAME</span> <span class="o">=</span> <span class="s1">&#39;MERRA2_100.tavg1_2d_slv_Nx.19800101.nc4&#39;</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span>


<span class="k">try</span><span class="p">:</span>
    <span class="n">result</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">FILENAME</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;contents of URL written to &#39;</span><span class="o">+</span><span class="n">FILENAME</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;requests.get() returned an error code &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">status_code</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>requests.get() returned an error code 401
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># To download multiple files, change the second temporal parameter</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">earthaccess</span><span class="o">.</span><span class="n">search_data</span><span class="p">(</span>
    <span class="n">doi</span><span class="o">=</span><span class="s2">&quot;10.5067/VJAFPLI1CSIV&quot;</span><span class="p">,</span>
    <span class="n">temporal</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;1980-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;1980-01-01&#39;</span><span class="p">),</span> <span class="c1"># This will stream one granule, but can be edited for a longer temporal extent</span>
    <span class="n">bounding_box</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">downloaded_files</span> <span class="o">=</span> <span class="n">earthaccess</span><span class="o">.</span><span class="n">download</span><span class="p">(</span>
    <span class="n">results</span><span class="p">,</span>
    <span class="n">local_path</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="c1"># Change this string to download to a different path</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Chapter2-DataManipulation"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="2.11_feature_engineering.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">2.11 Feature Engineering</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="2.13_MLready_data.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">2.13 ML-ready data</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By eScience Institute, University of Washington<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>