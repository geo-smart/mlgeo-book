
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>2.11 Feature Engineering &#8212; ML Geo Curriculum</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.12 Dimensionality Reduction" href="2.12_dimensionality_reduction.html" />
    <link rel="prev" title="2.10 Synthetic noise" href="2.10_synthetic_noise.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/GeoSMART_logo.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">ML Geo Curriculum</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../about_this_book/about_this_book.html">
                    Machine Learning in the Geosciences
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  About this Book
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://geo-smart.github.io/index.html">
   Geosmart website
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../about_this_book/acknowledgements.html">
   Acknowlegments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../about_this_book/0_mlgeo_project.html">
   Primer
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapter 1 - Open Source Ecosystem with Python
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter1-GettingStarted/readme.html">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter1-GettingStarted/1.1_open_reproducible_science.html">
   1.1 Open Reproducible Science
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter1-GettingStarted/1.2_jupyter_environment.html">
   1.3 Jupyter Environment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter1-GettingStarted/1.3_python_environment.html">
   1.3 Python Ecosystem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter1-GettingStarted/1.4_computational_environments.html">
   1.4 Computing Environments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter1-GettingStarted/1.5_version_control_git.html">
   1.5 Version Control &amp; GitHub
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter1-GettingStarted/1.6_data_gallery.html">
   1.6 Data Gallery
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapter 2 - Data Manipulation
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="2.1_Data_Definitions.html">
   2.1 Data Definitions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2.2_data_formats_rendered.html">
   2.2 Data Formats
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2.3_pandas_rendered.html">
   2.3 Pandas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2.4_dataframes_prep.html">
   2.4 DataFrame Exploration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2.5_Arrays.html">
   2.5 Data Arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2.6_resampling.html">
   2.6 Resampling Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2.7_statistical_considerations.html">
   2.7 Statistical Considerations for geoscientific Data and Noise
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2.8_data_spectral_transforms.html">
   2.8 Spectral Transforms
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2.9_filtering_data.html">
   2.9 Filtering Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2.10_synthetic_noise.html">
   2.10 Synthetic noise
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   2.11 Feature Engineering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2.12_dimensionality_reduction.html">
   2.12 Dimensionality Reduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2.13_MLready_data.html">
   2.13 ML-ready data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2.20_Final_Project_Assignement.html">
   Assignment:
   <strong>
    Preparing AI-Ready Data for The Final Project
   </strong>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapter 3 - Machine Learning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter3-MachineLearning/3.1_concepts_supervision.html">
   3.1 Concepts in training supervision
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter3-MachineLearning/3.2_classification_regression.html">
   3.2 Classification and Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter3-MachineLearning/3.3_clustering.html">
   3.3 Clustering: Unsupervied Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter3-MachineLearning/3.4_binary_classification.html">
   3.4 Binary classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter3-MachineLearning/3.5_multiclass_classification.html">
   3.5 Multiclass Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter3-MachineLearning/3.6_logistic_regression.html">
   3.6 Logistic regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter3-MachineLearning/3.7_randomForest_regression.html">
   3.7 Random Forests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter3-MachineLearning/3.8_robust_training.html">
   3.8 Robust Training
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter3-MachineLearning/3.9_ensemble_learning.html">
   3.9 Ensemble learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter3-MachineLearning/3.10_autoML.html">
   3.10 AutoML
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter3-MachineLearning/3.20_final_project_cml.html">
   3.20 Final Project - Classic Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter3-MachineLearning/Homework_CML.html">
   Homework Classic Machine Learning (50 points)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapter 4 - Deep Learning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter4-DeepLearning/mlgeo_4.0_perceptrons.html">
   4.0 The Perceptron
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter4-DeepLearning/mlgeo_4.1_neural_networks.html">
   4.1 Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter4-DeepLearning/mlgeo_4.2_MultiLayerPerceptron.html">
   4.2 Multi Layer Perceptrons
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter4-DeepLearning/mlgeo_4.3_ModelTraining.html">
   4.3 Model Training
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter4-DeepLearning/mlgeo_4.3_PINN.html">
   4.2 Physics-Informed Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter4-DeepLearning/mlgeo_4.3_CNN.html">
   4.3 Convolutional Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter4-DeepLearning/mlgeo_4.5_RNN.html">
   4.4  Recurrent Neural Networks: Processing sequences
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter4-DeepLearning/mlgeo_4.6_AutoEncoder.html">
   4.5 Auto-encoders
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter4-DeepLearning/mlgeo_4.6_NAS.html">
   4.6 NAS: Network Architecture Search
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapter 5 - Workflow Management and Reproducibility
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter5-ModelWorkflows/readme.html">
   This chapter focuces on model workflow and ML reproducibility
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapter 6- Introduction to Cloud Computing
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/cloudmaven">
   Browser Access to Cloud Instances
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/Denolle-Lab/azure">
   Terraform Access to Cloud Instances
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://tljh.jupyter.org/en/latest/">
   Cloud Provider ML Jupyterhubs
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Reference
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../reference/glossary.html">
   Glossaries
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../reference/bibliography.html">
   Bibliography
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/geo-smart/mlgeo-book/main?urlpath=lab/tree/book/Chapter2-DataManipulation/2.11_feature_engineering.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/geo-smart/mlgeo-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/geo-smart/mlgeo-book/issues/new?title=Issue%20on%20page%20%2FChapter2-DataManipulation/2.11_feature_engineering.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/geo-smart/mlgeo-book/edit/main/book/Chapter2-DataManipulation/2.11_feature_engineering.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/Chapter2-DataManipulation/2.11_feature_engineering.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   1. Introduction
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#statistical-features">
     Statistical features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#temporal-features">
     Temporal Features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spatial-features">
     Spatial features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fractal-features">
     Fractal Features
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#seismic-time-series-data-example">
   2. Seismic Time Series Data Example
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#metadata">
   Metadata
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#new-dataframe-clean-up">
     New DataFrame Clean up
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#explore-correlation-among-features">
   Explore correlation  among features
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exploring-the-feature-space-for-classification-purpose">
   Exploring the feature space for classification purpose
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#student-exercise">
     Student exercise
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>2.11 Feature Engineering</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   1. Introduction
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#statistical-features">
     Statistical features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#temporal-features">
     Temporal Features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spatial-features">
     Spatial features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fractal-features">
     Fractal Features
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#seismic-time-series-data-example">
   2. Seismic Time Series Data Example
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#metadata">
   Metadata
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#new-dataframe-clean-up">
     New DataFrame Clean up
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#explore-correlation-among-features">
   Explore correlation  among features
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exploring-the-feature-space-for-classification-purpose">
   Exploring the feature space for classification purpose
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#student-exercise">
     Student exercise
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="feature-engineering">
<h1>2.11 Feature Engineering<a class="headerlink" href="#feature-engineering" title="Permalink to this headline">#</a></h1>
<section id="introduction">
<h2>1. Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
<p>The process of feature engineering involves manipulating, transforming, and selecting raw data into features that can be used in statistical analysis and prediction.</p>
<p>Key types of features include:</p>
<section id="statistical-features">
<h3>Statistical features<a class="headerlink" href="#statistical-features" title="Permalink to this headline">#</a></h3>
<p>Statistical features summarize the distribution of data values, providing insights into the central tendency, dispersion, and shape of the dataset.</p>
<ul class="simple">
<li><p><strong>Mean</strong>: Average value of the data points.</p></li>
<li><p><strong>Variance/Standard Deviation</strong>: Measure of the spread of the data.</p></li>
<li><p><strong>Skewness</strong>: Asymmetry in the distribution of values.</p></li>
<li><p><strong>Kurtosis</strong>: “Tailedness” of the distribution.</p></li>
<li><p><strong>Percentiles</strong> : Threshold values for different segments of the distribution.</p></li>
</ul>
</section>
<section id="temporal-features">
<h3>Temporal Features<a class="headerlink" href="#temporal-features" title="Permalink to this headline">#</a></h3>
<p>Temporal features focus on the time-dependent patterns within the series.</p>
<ul class="simple">
<li><p><strong>Autocorrelation</strong>: Correlation of a time series with a lagged version of itself.</p></li>
<li><p><strong>Trend</strong>: Long-term increase or decrease in the data.</p></li>
<li><p><strong>Seasonality</strong>: Regular patterns that repeat over a specific period.</p></li>
<li><p><strong>Change Points</strong>: Locations where statistical properties of the series change significantly.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Create a time series with trend and seasonality</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">365</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<span class="n">seasonal_series</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="mi">365</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="mi">365</span><span class="p">)</span> <span class="o">+</span> \
        <span class="mi">2</span><span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="mi">365</span><span class="p">))</span>

<span class="c1"># fit a trend using least squares regression</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seasonal_series</span><span class="p">))</span>
<span class="n">trend</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">seasonal_series</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">seasonal_series</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># calculate the seasonal component by subtracting the trend</span>
<span class="n">seasonal</span> <span class="o">=</span> <span class="n">seasonal_series</span> <span class="o">-</span> <span class="n">trend</span>
<span class="c1"># calculate the autocorrelation of the seasonal component</span>
<span class="n">autocorr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">seasonal</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">seasonal</span><span class="p">[</span><span class="mi">1</span><span class="p">:])[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The autocorrelation of the seasonal component is </span><span class="si">{</span><span class="n">autocorr</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Plot the original time series, trend and seasonal components</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">seasonal_series</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original Time Series&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">trend</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Trend&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">seasonal</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Seasonal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The autocorrelation of the seasonal component is 0.63
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x319ac7fd0&gt;
</pre></div>
</div>
<img alt="../_images/2.11_feature_engineering_1_2.png" src="../_images/2.11_feature_engineering_1_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="mi">365</span><span class="p">)</span> 

<span class="n">autocorr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">crap</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">crap</span><span class="p">[</span><span class="mi">1</span><span class="p">:])[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The autocorrelation of the seasonal component is </span><span class="si">{</span><span class="n">autocorr</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The autocorrelation of the seasonal component is 0.01
</pre></div>
</div>
</div>
</div>
</section>
<section id="spatial-features">
<h3>Spatial features<a class="headerlink" href="#spatial-features" title="Permalink to this headline">#</a></h3>
<p>For geospatial data, spatial features capture the relationships between different locations in an image or dataset.</p>
<ul class="simple">
<li><p><strong>Texture</strong>: Patterns in the local intensity variations (e.g., smooth, rough).</p></li>
<li><p><strong>Spatial Correlation</strong>: Measures how similar nearby locations are in terms of intensity values.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="kn">import</span> <span class="n">gaussian_filter</span>
<span class="kn">from</span> <span class="nn">scipy.fft</span> <span class="kn">import</span> <span class="n">fft2</span><span class="p">,</span> <span class="n">ifft2</span><span class="p">,</span> <span class="n">fftshift</span>

<span class="c1"># Generate a 2D grid (e.g., geospatial data, such as a topographic map)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># Size of the grid</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># Generate 2D white noise</span>
<span class="n">white_noise_2d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

<span class="c1"># Generate spatially correlated noise using a Gaussian filter</span>
<span class="n">spatially_correlated_noise</span> <span class="o">=</span> <span class="n">gaussian_filter</span><span class="p">(</span><span class="n">white_noise_2d</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># Plot the synthetic 2D white noise, correlated noise, and autocorrelation function</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">white_noise_2d</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;2D White Noise&#39;</span><span class="p">)</span>

<span class="c1"># Spatially correlated noise</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">spatially_correlated_noise</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;2D Spatially Correlated Noise&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;2D Spatially Correlated Noise&#39;)
</pre></div>
</div>
<img alt="../_images/2.11_feature_engineering_4_1.png" src="../_images/2.11_feature_engineering_4_1.png" />
</div>
</div>
<p>spatial correlation of the white noise</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute the 2D Fourier Transform of the spatially correlated noise</span>
<span class="n">fft_white_noise</span> <span class="o">=</span> <span class="n">fft2</span><span class="p">(</span><span class="n">white_noise_2d</span><span class="p">)</span>

<span class="c1"># Compute the power spectrum</span>
<span class="n">power_spectrum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fft_white_noise</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>

<span class="c1"># Compute the inverse 2D Fourier Transform of the power spectrum to get the autocorrelation function</span>
<span class="n">autocorrelation_white</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">ifft2</span><span class="p">(</span><span class="n">power_spectrum</span><span class="p">))</span>

<span class="c1"># Shift the zero-frequency component to the center of the spectrum</span>
<span class="n">autocorrelation_white</span> <span class="o">=</span> <span class="n">fftshift</span><span class="p">(</span><span class="n">autocorrelation_white</span><span class="p">)</span>

<span class="c1"># Normalize the autocorrelation function</span>
<span class="n">autocorrelation_white</span> <span class="o">/=</span> <span class="n">autocorrelation_white</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>spatial correlation of the correlated noise</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute the 2D Fourier Transform of the spatially correlated noise</span>
<span class="n">fft_noise</span> <span class="o">=</span> <span class="n">fft2</span><span class="p">(</span><span class="n">spatially_correlated_noise</span><span class="p">)</span>

<span class="c1"># Compute the power spectrum</span>
<span class="n">power_spectrum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fft_noise</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>

<span class="c1"># Compute the inverse 2D Fourier Transform of the power spectrum to get the autocorrelation function</span>
<span class="n">autocorrelation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">ifft2</span><span class="p">(</span><span class="n">power_spectrum</span><span class="p">))</span>

<span class="c1"># Shift the zero-frequency component to the center of the spectrum</span>
<span class="n">autocorrelation</span> <span class="o">=</span> <span class="n">fftshift</span><span class="p">(</span><span class="n">autocorrelation</span><span class="p">)</span>

<span class="c1"># Normalize the autocorrelation function</span>
<span class="n">autocorrelation</span> <span class="o">/=</span> <span class="n">autocorrelation</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the synthetic 2D white noise, correlated noise, and autocorrelation function</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># White noise (unfiltered)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">white_noise_2d</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;2D White Noise&#39;</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">autocorrelation_white</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;2D White Noise Autocorrelation&#39;</span><span class="p">)</span>


<span class="c1"># Spatially correlated noise</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">spatially_correlated_noise</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;2D Spatially Correlated Noise&#39;</span><span class="p">)</span>

<span class="c1"># Autocorrelation function</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">autocorrelation</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Normalized Amplitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Autocorrelation Function&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2.11_feature_engineering_9_0.png" src="../_images/2.11_feature_engineering_9_0.png" />
</div>
</div>
<p>Estimate the feature “correlation length” of the two images. The correlation length is often measured as the distance at which the autocorelation function decays to 1/e of its maximum value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">center</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span>
<span class="c1"># calculate correlation length for the white noise</span>
<span class="n">autocorr_center</span> <span class="o">=</span> <span class="n">autocorrelation_white</span><span class="p">[</span><span class="n">center</span><span class="p">,</span> <span class="n">center</span><span class="p">:]</span>
<span class="n">distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">center</span><span class="p">)</span>
<span class="n">correlation_length_white</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="n">autocorr_center</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">distances</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># calculate correlation length for the spatially correlated noise </span>
<span class="n">autocorr_center</span> <span class="o">=</span> <span class="n">autocorrelation</span><span class="p">[</span><span class="n">center</span><span class="p">,</span> <span class="n">center</span><span class="p">:]</span>
<span class="n">distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">center</span><span class="p">)</span>
<span class="n">correlation_length</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="n">autocorr_center</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">distances</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Estimated correlation length for white noise: </span><span class="si">{</span><span class="n">correlation_length_white</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> and for spatially correlated noise: </span><span class="si">{</span><span class="n">correlation_length</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Estimated correlation length for white noise: 0.06 and for spatially correlated noise: 0.66
</pre></div>
</div>
</div>
</div>
</section>
<section id="fractal-features">
<h3>Fractal Features<a class="headerlink" href="#fractal-features" title="Permalink to this headline">#</a></h3>
<p>Fractal features describe the self-similarity or complexity of the data at different scales. A common fractal feature is the Fractal Dimension, which quantifies the complexity of a dataset, especially useful in understanding geospatial structures and irregular patterns.</p>
</section>
</section>
<section id="seismic-time-series-data-example">
<h2>2. Seismic Time Series Data Example<a class="headerlink" href="#seismic-time-series-data-example" title="Permalink to this headline">#</a></h2>
<p>This lecture will demonstrate how to automatically extract features using a popular and simple Python package, <code class="docutils literal notranslate"><span class="pre">tsfel</span></code>, to extract common time series features. We will apply this to the example of seismic waveforms recorded in the Pacific Northwest.</p>
<p>An example will follow.
The Pacific Northwest data includes labeled seismic waveforms for events of various origins:</p>
<ul class="simple">
<li><p><strong>Earthquakes</strong></p></li>
<li><p><strong>Explosions</strong> (mostly quarry blasts)</p></li>
<li><p><strong>Surface events</strong> (such as avalanches and landslides)</p></li>
<li><p><strong>Seismic noise</strong> (ambient Earth vibrations between events)</p></li>
</ul>
<p>We will explore how these features vary across the four categories, or classes, of seismic events.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import modules for seismic data and feature extraction</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">st</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">h5py</span> <span class="c1"># for reading .h5 files</span>
</pre></div>
</div>
</div>
</div>
<p>We download 2 files from the class storage: a CSV file with the waveforms themselves as an HDF5 file and their associated metadata as a CSV file:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#make sure to install wget</span>
<span class="o">!</span>pip install wget
<span class="kn">import</span> <span class="nn">wget</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: wget in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (3.2)

<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> A new release of pip is available: <span class=" -Color -Color-Red">23.3.1</span> -&gt; <span class=" -Color -Color-Green">24.2</span>
<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> To update, run: <span class=" -Color -Color-Green">pip install --upgrade pip</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;https://dasway.ess.washington.edu/shared/niyiyu/PNW-ML/miniPNW_metadata.csv&quot;</span><span class="p">)</span>
<span class="n">wget</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;https://dasway.ess.washington.edu/shared/niyiyu/PNW-ML/miniPNW_waveforms.hdf5&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;miniPNW_waveforms.hdf5&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="metadata">
<h2>Metadata<a class="headerlink" href="#metadata" title="Permalink to this headline">#</a></h2>
<p>We first read the metadata and arange them into a Pandas Data frame</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="c1"># Handle irregular rows by skipping them</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;miniPNW_metadata.csv&quot;</span><span class="p">)</span>
<span class="c1"># Display the first few rows of the DataFrame</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>event_id</th>
      <th>source_origin_time</th>
      <th>source_latitude_deg</th>
      <th>source_longitude_deg</th>
      <th>source_type</th>
      <th>source_depth_km</th>
      <th>preferred_source_magnitude</th>
      <th>preferred_source_magnitude_type</th>
      <th>preferred_source_magnitude_uncertainty</th>
      <th>...</th>
      <th>trace_S_onset</th>
      <th>trace_P_onset</th>
      <th>trace_snr_db</th>
      <th>year</th>
      <th>source_type_pnsn_label</th>
      <th>source_local_magnitude</th>
      <th>source_local_magnitude_uncertainty</th>
      <th>source_duration_magnitude</th>
      <th>source_duration_magnitude_uncertainty</th>
      <th>source_hand_magnitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>uw61669232</td>
      <td>2020-09-07T03:44:14.690000Z</td>
      <td>46.560</td>
      <td>-119.797</td>
      <td>earthquake</td>
      <td>23.300</td>
      <td>1.30</td>
      <td>ml</td>
      <td>0.241000</td>
      <td>...</td>
      <td>impulsive</td>
      <td>impulsive</td>
      <td>-1.444|2.612|9.921</td>
      <td>2020.0</td>
      <td>eq</td>
      <td>1.30</td>
      <td>0.241273</td>
      <td>1.17</td>
      <td>0.187840</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>uw60888282</td>
      <td>2014-10-08T15:39:31.330000Z</td>
      <td>45.371</td>
      <td>-121.708</td>
      <td>earthquake</td>
      <td>-0.947</td>
      <td>1.67</td>
      <td>ml</td>
      <td>0.128000</td>
      <td>...</td>
      <td>impulsive</td>
      <td>impulsive</td>
      <td>0.368|3.526|5.981</td>
      <td>2014.0</td>
      <td>eq</td>
      <td>1.67</td>
      <td>0.128000</td>
      <td>1.63</td>
      <td>0.099000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>uw61361706</td>
      <td>2017-12-30T04:37:46.870000Z</td>
      <td>46.165</td>
      <td>-120.543</td>
      <td>earthquake</td>
      <td>13.520</td>
      <td>2.46</td>
      <td>ml</td>
      <td>0.158000</td>
      <td>...</td>
      <td>impulsive</td>
      <td>emergent</td>
      <td>11.274|13.32|15.828</td>
      <td>2017.0</td>
      <td>eq</td>
      <td>2.46</td>
      <td>0.158000</td>
      <td>3.37</td>
      <td>0.389000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>uw61639436</td>
      <td>2020-06-09T23:37:10.420000Z</td>
      <td>46.542</td>
      <td>-119.589</td>
      <td>earthquake</td>
      <td>16.370</td>
      <td>1.59</td>
      <td>ml</td>
      <td>0.157000</td>
      <td>...</td>
      <td>impulsive</td>
      <td>emergent</td>
      <td>27.007|20.797|19.252</td>
      <td>2020.0</td>
      <td>eq</td>
      <td>1.59</td>
      <td>0.156750</td>
      <td>1.69</td>
      <td>0.354773</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>uw61735446</td>
      <td>2021-05-24T10:42:37.810000Z</td>
      <td>46.857</td>
      <td>-121.941</td>
      <td>earthquake</td>
      <td>12.380</td>
      <td>0.83</td>
      <td>ml</td>
      <td>0.082983</td>
      <td>...</td>
      <td>impulsive</td>
      <td>emergent</td>
      <td>18.579|18.912|7.609</td>
      <td>2021.0</td>
      <td>eq</td>
      <td>0.83</td>
      <td>0.082983</td>
      <td>0.50</td>
      <td>0.381880</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 37 columns</p>
</div></div></div>
</div>
<p>The nature of the event source is located in one of the metadata attributes</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;source_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;earthquake&#39;, &#39;explosion&#39;, &#39;sonic_boom&#39;, &#39;thunder&#39;,
       &#39;surface_event&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>Let’s assume that we are exploring features to classify the waveforms into the categories of the event types. We will attribute the *<em>labels</em> as the <code class="docutils literal notranslate"><span class="pre">source_type</span></code> attribute.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">labels</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;source_type&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>source_type
earthquake       500
explosion        500
surface_event    500
sonic_boom       126
thunder           94
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>How many seismic waveforms are there in each of the category?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##</span>
</pre></div>
</div>
</div>
</div>
<p>Would you say that this is a balanced data set with respect to the four classes of interest?</p>
<p>Now we will look at the seismic data, taking a random waveform from each of the categories</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([500.,   0., 500.,   0.,   0., 126.,   0.,  94.,   0., 500.]),
 array([0. , 0.4, 0.8, 1.2, 1.6, 2. , 2.4, 2.8, 3.2, 3.6, 4. ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/2.11_feature_engineering_29_1.png" src="../_images/2.11_feature_engineering_29_1.png" />
</div>
</div>
<p>Now are read the data. It is stored in an HDF5 files under a finite number of groups. Each groups has an array of datasets that correspond to the waveforms. To link the metadata to the waveform files, the key trace_name has the dataset ID. The address is labeled as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>bucketX$i,:3,:n
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">X</span></code> is the HDF5 group number, <code class="docutils literal notranslate"><span class="pre">i</span></code> is the index. The file has typically 3 waveforms from each direction of ground motions N, E, Z. In the following exercise, we will focus on the vertical waveforms.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s2">&quot;miniPNW_waveforms.hdf5&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chan_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Below a function to read the file in the data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">read_data</span><span class="p">(</span><span class="n">tn</span><span class="p">,</span><span class="n">f</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to read the waveform data from the .h5 file</span>
<span class="sd">    tn: trace_name of the waveform</span>
<span class="sd">    f: file object of the .h5 file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bucket</span><span class="p">,</span> <span class="n">narray</span> <span class="o">=</span> <span class="n">tn</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="p">)</span>  <span class="c1"># split the string of trace_name into bucket and narray</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">narray</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,:&#39;</span><span class="p">)])</span> <span class="c1"># split the narray into x, y, z</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;/data/</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">bucket</span><span class="p">][</span><span class="n">x</span><span class="p">,</span> <span class="p">:</span><span class="n">y</span><span class="p">,</span> <span class="p">:</span><span class="n">z</span><span class="p">]</span> <span class="c1"># read the data as a 3D array</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
</div>
</div>
<p>The trace name is stored as data attriobute in the metadata.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ldata</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;trace_name&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ldata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;bucket1$0,:3,:15001&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crap</span><span class="o">=</span><span class="n">read_data</span><span class="p">(</span><span class="n">ldata</span><span class="p">[</span><span class="mi">530</span><span class="p">],</span><span class="n">f</span><span class="p">)</span>
<span class="c1">#print the dimension of a givan data</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The first dimension of the data is </span><span class="si">{</span><span class="n">crap</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The second dimension of the data is </span><span class="si">{</span><span class="n">crap</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># the time vector of the data goes from 0 to 150 seconds with a sampling rate of 100Hz</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">crap</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># plot an example of the data in a 3 row subplot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">crap</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Channel </span><span class="si">{</span><span class="n">chan_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The first dimension of the data is 3
The second dimension of the data is 15001
</pre></div>
</div>
<img alt="../_images/2.11_feature_engineering_38_1.png" src="../_images/2.11_feature_engineering_38_1.png" />
</div>
</div>
<p>We will just extract the Z component and reshape them into a single array.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nt</span><span class="o">=</span><span class="n">crap</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ndata</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span class="n">Z</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">ndata</span><span class="p">,</span><span class="n">nt</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndata</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">=</span><span class="n">read_data</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;trace_name&quot;</span><span class="p">],</span><span class="n">f</span><span class="p">)[</span><span class="mi">2</span><span class="p">,:</span><span class="n">nt</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Now we have data and its attributes, in particular the label as source type.</p>
<p>We are going to extract features automatically from tsfel and explore how varied the</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip install tsfel
<span class="kn">import</span> <span class="nn">tsfel</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: tsfel in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (0.1.6)
Requirement already satisfied: ipython&gt;=7.4.0 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from tsfel) (8.16.1)
Requirement already satisfied: numpy&gt;=1.18.5 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from tsfel) (1.26.0)
Requirement already satisfied: pandas&gt;=1.5.3 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from tsfel) (2.1.1)
Requirement already satisfied: scipy&gt;=1.7.3 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from tsfel) (1.11.3)
Requirement already satisfied: setuptools&gt;=47.1.1 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from tsfel) (68.2.2)
Requirement already satisfied: backcall in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from ipython&gt;=7.4.0-&gt;tsfel) (0.2.0)
Requirement already satisfied: decorator in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from ipython&gt;=7.4.0-&gt;tsfel) (5.1.1)
Requirement already satisfied: jedi&gt;=0.16 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from ipython&gt;=7.4.0-&gt;tsfel) (0.19.1)
Requirement already satisfied: matplotlib-inline in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from ipython&gt;=7.4.0-&gt;tsfel) (0.1.6)
Requirement already satisfied: pickleshare in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from ipython&gt;=7.4.0-&gt;tsfel) (0.7.5)
Requirement already satisfied: prompt-toolkit!=3.0.37,&lt;3.1.0,&gt;=3.0.30 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from ipython&gt;=7.4.0-&gt;tsfel) (3.0.39)
Requirement already satisfied: pygments&gt;=2.4.0 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from ipython&gt;=7.4.0-&gt;tsfel) (2.16.1)
Requirement already satisfied: stack-data in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from ipython&gt;=7.4.0-&gt;tsfel) (0.6.2)
Requirement already satisfied: traitlets&gt;=5 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from ipython&gt;=7.4.0-&gt;tsfel) (5.11.2)
Requirement already satisfied: typing-extensions in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from ipython&gt;=7.4.0-&gt;tsfel) (4.5.0)
Requirement already satisfied: exceptiongroup in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from ipython&gt;=7.4.0-&gt;tsfel) (1.1.3)
Requirement already satisfied: pexpect&gt;4.3 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from ipython&gt;=7.4.0-&gt;tsfel) (4.8.0)
Requirement already satisfied: appnope in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from ipython&gt;=7.4.0-&gt;tsfel) (0.1.3)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from pandas&gt;=1.5.3-&gt;tsfel) (2.8.2)
Requirement already satisfied: pytz&gt;=2020.1 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from pandas&gt;=1.5.3-&gt;tsfel) (2023.3.post1)
Requirement already satisfied: tzdata&gt;=2022.1 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from pandas&gt;=1.5.3-&gt;tsfel) (2023.3)
Requirement already satisfied: parso&lt;0.9.0,&gt;=0.8.3 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from jedi&gt;=0.16-&gt;ipython&gt;=7.4.0-&gt;tsfel) (0.8.3)
Requirement already satisfied: ptyprocess&gt;=0.5 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from pexpect&gt;4.3-&gt;ipython&gt;=7.4.0-&gt;tsfel) (0.7.0)
Requirement already satisfied: wcwidth in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from prompt-toolkit!=3.0.37,&lt;3.1.0,&gt;=3.0.30-&gt;ipython&gt;=7.4.0-&gt;tsfel) (0.2.8)
Requirement already satisfied: six&gt;=1.5 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from python-dateutil&gt;=2.8.2-&gt;pandas&gt;=1.5.3-&gt;tsfel) (1.16.0)
Requirement already satisfied: executing&gt;=1.2.0 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from stack-data-&gt;ipython&gt;=7.4.0-&gt;tsfel) (1.2.0)
Requirement already satisfied: asttokens&gt;=2.1.0 in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from stack-data-&gt;ipython&gt;=7.4.0-&gt;tsfel) (2.4.0)
Requirement already satisfied: pure-eval in /Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages (from stack-data-&gt;ipython&gt;=7.4.0-&gt;tsfel) (0.2.2)

<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> A new release of pip is available: <span class=" -Color -Color-Red">23.3.1</span> -&gt; <span class=" -Color -Color-Green">24.2</span>
<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> To update, run: <span class=" -Color -Color-Green">pip install --upgrade pip</span>
</pre></div>
</div>
</div>
</div>
<p>We need to format for input into tsfresh. It needs 1 column with the <code class="docutils literal notranslate"><span class="pre">id</span></code> (or label), one column for the time stamps (<code class="docutils literal notranslate"><span class="pre">sort</span></code>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cfg</span> <span class="o">=</span> <span class="n">tsfel</span><span class="o">.</span><span class="n">get_features_by_domain</span><span class="p">()</span>    
<span class="nb">print</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;spectral&#39;: {&#39;FFT mean coefficient&#39;: {&#39;complexity&#39;: &#39;constant&#39;, &#39;description&#39;: &#39;Computes the mean value of each spectrogram frequency.&#39;, &#39;function&#39;: &#39;tsfel.fft_mean_coeff&#39;, &#39;parameters&#39;: {&#39;fs&#39;: 100, &#39;nfreq&#39;: 256}, &#39;n_features&#39;: &#39;nfreq&#39;, &#39;use&#39;: &#39;yes&#39;}, &#39;Fundamental frequency&#39;: {&#39;complexity&#39;: &#39;log&#39;, &#39;description&#39;: &#39;Computes the fundamental frequency.&#39;, &#39;function&#39;: &#39;tsfel.fundamental_frequency&#39;, &#39;parameters&#39;: {&#39;fs&#39;: 100}, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Human range energy&#39;: {&#39;complexity&#39;: &#39;log&#39;, &#39;description&#39;: &#39;Computes the human range energy ratio given by the ratio between the energy in frequency 0.6-2.5Hz and the whole energy band.&#39;, &#39;function&#39;: &#39;tsfel.human_range_energy&#39;, &#39;parameters&#39;: {&#39;fs&#39;: 100}, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;, &#39;tag&#39;: &#39;inertial&#39;}, &#39;LPCC&#39;: {&#39;complexity&#39;: &#39;log&#39;, &#39;description&#39;: &#39;Computes the linear prediction cepstral coefficients.&#39;, &#39;function&#39;: &#39;tsfel.lpcc&#39;, &#39;parameters&#39;: {&#39;n_coeff&#39;: 12}, &#39;n_features&#39;: &#39;n_coeff&#39;, &#39;use&#39;: &#39;yes&#39;, &#39;tag&#39;: &#39;audio&#39;}, &#39;MFCC&#39;: {&#39;complexity&#39;: &#39;constant&#39;, &#39;description&#39;: &#39;Computes the MEL cepstral coefficients.&#39;, &#39;function&#39;: &#39;tsfel.mfcc&#39;, &#39;parameters&#39;: {&#39;cep_lifter&#39;: 22, &#39;fs&#39;: 100, &#39;nfft&#39;: 512, &#39;nfilt&#39;: 40, &#39;num_ceps&#39;: 12, &#39;pre_emphasis&#39;: 0.97}, &#39;n_features&#39;: &#39;num_ceps&#39;, &#39;use&#39;: &#39;yes&#39;, &#39;tag&#39;: [&#39;audio&#39;, &#39;emg&#39;]}, &#39;Max power spectrum&#39;: {&#39;complexity&#39;: &#39;log&#39;, &#39;description&#39;: &#39;Computes the maximum power spectrum density.&#39;, &#39;function&#39;: &#39;tsfel.max_power_spectrum&#39;, &#39;parameters&#39;: {&#39;fs&#39;: 100}, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Maximum frequency&#39;: {&#39;complexity&#39;: &#39;log&#39;, &#39;description&#39;: &#39;Computes the maximum frequency.&#39;, &#39;function&#39;: &#39;tsfel.max_frequency&#39;, &#39;parameters&#39;: {&#39;fs&#39;: 100}, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Median frequency&#39;: {&#39;complexity&#39;: &#39;log&#39;, &#39;description&#39;: &#39;Computes the median frequency.&#39;, &#39;function&#39;: &#39;tsfel.median_frequency&#39;, &#39;parameters&#39;: {&#39;fs&#39;: 100}, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Power bandwidth&#39;: {&#39;complexity&#39;: &#39;log&#39;, &#39;description&#39;: &#39;Computes power spectrum density bandwidth of the signal.&#39;, &#39;function&#39;: &#39;tsfel.power_bandwidth&#39;, &#39;parameters&#39;: {&#39;fs&#39;: 100}, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Spectral centroid&#39;: {&#39;complexity&#39;: &#39;linear&#39;, &#39;description&#39;: &#39;Computes the barycenter of the spectrum.&#39;, &#39;function&#39;: &#39;tsfel.spectral_centroid&#39;, &#39;parameters&#39;: {&#39;fs&#39;: 100}, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;, &#39;tag&#39;: &#39;audio&#39;}, &#39;Spectral decrease&#39;: {&#39;complexity&#39;: &#39;log&#39;, &#39;description&#39;: &#39;Computes the amount of decreasing of the spectra amplitude.&#39;, &#39;function&#39;: &#39;tsfel.spectral_decrease&#39;, &#39;parameters&#39;: {&#39;fs&#39;: 100}, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Spectral distance&#39;: {&#39;complexity&#39;: &#39;log&#39;, &#39;description&#39;: &#39;Computes the signal spectral distance.&#39;, &#39;function&#39;: &#39;tsfel.spectral_distance&#39;, &#39;parameters&#39;: {&#39;fs&#39;: 100}, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Spectral entropy&#39;: {&#39;complexity&#39;: &#39;log&#39;, &#39;description&#39;: &#39;Computes the spectral entropy of the signal based on Fourier transform.&#39;, &#39;function&#39;: &#39;tsfel.spectral_entropy&#39;, &#39;parameters&#39;: {&#39;fs&#39;: 100}, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;, &#39;tag&#39;: &#39;eeg&#39;}, &#39;Spectral kurtosis&#39;: {&#39;complexity&#39;: &#39;linear&#39;, &#39;description&#39;: &#39;Computes the flatness of a distribution around its mean value.&#39;, &#39;function&#39;: &#39;tsfel.spectral_kurtosis&#39;, &#39;parameters&#39;: {&#39;fs&#39;: 100}, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Spectral positive turning points&#39;: {&#39;complexity&#39;: &#39;log&#39;, &#39;description&#39;: &#39;Computes number of positive turning points of the fft magnitude signal&#39;, &#39;function&#39;: &#39;tsfel.spectral_positive_turning&#39;, &#39;parameters&#39;: {&#39;fs&#39;: 100}, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Spectral roll-off&#39;: {&#39;complexity&#39;: &#39;log&#39;, &#39;description&#39;: &#39;Computes the frequency where 95% of the signal magnitude is contained below of this value.&#39;, &#39;function&#39;: &#39;tsfel.spectral_roll_off&#39;, &#39;parameters&#39;: {&#39;fs&#39;: 100}, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;, &#39;tag&#39;: &#39;audio&#39;}, &#39;Spectral roll-on&#39;: {&#39;complexity&#39;: &#39;log&#39;, &#39;description&#39;: &#39;Computes the frequency where 5% of the signal magnitude is contained below of this value.&#39;, &#39;function&#39;: &#39;tsfel.spectral_roll_on&#39;, &#39;parameters&#39;: {&#39;fs&#39;: 100}, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Spectral skewness&#39;: {&#39;complexity&#39;: &#39;linear&#39;, &#39;description&#39;: &#39;Computes the asymmetry of a distribution around its mean value.&#39;, &#39;function&#39;: &#39;tsfel.spectral_skewness&#39;, &#39;parameters&#39;: {&#39;fs&#39;: 100}, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Spectral slope&#39;: {&#39;complexity&#39;: &#39;log&#39;, &#39;description&#39;: &#39;Computes the spectral slope, obtained by linear regression of the spectral amplitude.&#39;, &#39;function&#39;: &#39;tsfel.spectral_slope&#39;, &#39;parameters&#39;: {&#39;fs&#39;: 100}, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Spectral spread&#39;: {&#39;complexity&#39;: &#39;linear&#39;, &#39;description&#39;: &#39;Computes the spread of the spectrum around its mean value.&#39;, &#39;function&#39;: &#39;tsfel.spectral_spread&#39;, &#39;parameters&#39;: {&#39;fs&#39;: 100}, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Spectral variation&#39;: {&#39;complexity&#39;: &#39;log&#39;, &#39;description&#39;: &#39;Computes the amount of variation of the spectrum along time.&#39;, &#39;function&#39;: &#39;tsfel.spectral_variation&#39;, &#39;parameters&#39;: {&#39;fs&#39;: 100}, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Wavelet absolute mean&#39;: {&#39;complexity&#39;: &#39;linear&#39;, &#39;description&#39;: &#39;Computes CWT absolute mean value of each wavelet scale.&#39;, &#39;function&#39;: &#39;tsfel.wavelet_abs_mean&#39;, &#39;parameters&#39;: {&#39;function&#39;: &#39;scipy.signal.ricker&#39;, &#39;widths&#39;: &#39;np.arange(1,10)&#39;}, &#39;n_features&#39;: &#39;widths&#39;, &#39;use&#39;: &#39;yes&#39;, &#39;tag&#39;: [&#39;eeg&#39;, &#39;ecg&#39;]}, &#39;Wavelet energy&#39;: {&#39;complexity&#39;: &#39;linear&#39;, &#39;description&#39;: &#39;Computes CWT energy of each wavelet scale.&#39;, &#39;function&#39;: &#39;tsfel.wavelet_energy&#39;, &#39;parameters&#39;: {&#39;function&#39;: &#39;scipy.signal.ricker&#39;, &#39;widths&#39;: &#39;np.arange(1,10)&#39;}, &#39;n_features&#39;: &#39;widths&#39;, &#39;use&#39;: &#39;yes&#39;, &#39;tag&#39;: &#39;eeg&#39;}, &#39;Wavelet entropy&#39;: {&#39;complexity&#39;: &#39;linear&#39;, &#39;description&#39;: &#39;Computes CWT entropy of the signal.&#39;, &#39;function&#39;: &#39;tsfel.wavelet_entropy&#39;, &#39;parameters&#39;: {&#39;function&#39;: &#39;scipy.signal.ricker&#39;, &#39;widths&#39;: &#39;np.arange(1,10)&#39;}, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;, &#39;tag&#39;: &#39;eeg&#39;}, &#39;Wavelet standard deviation&#39;: {&#39;complexity&#39;: &#39;linear&#39;, &#39;description&#39;: &#39;Computes CWT std value of each wavelet scale.&#39;, &#39;function&#39;: &#39;tsfel.wavelet_std&#39;, &#39;parameters&#39;: {&#39;function&#39;: &#39;scipy.signal.ricker&#39;, &#39;widths&#39;: &#39;np.arange(1,10)&#39;}, &#39;n_features&#39;: &#39;widths&#39;, &#39;use&#39;: &#39;yes&#39;, &#39;tag&#39;: &#39;eeg&#39;}, &#39;Wavelet variance&#39;: {&#39;complexity&#39;: &#39;linear&#39;, &#39;description&#39;: &#39;Computes CWT variance value of each wavelet scale.&#39;, &#39;function&#39;: &#39;tsfel.wavelet_var&#39;, &#39;parameters&#39;: {&#39;function&#39;: &#39;scipy.signal.ricker&#39;, &#39;widths&#39;: &#39;np.arange(1,10)&#39;}, &#39;n_features&#39;: &#39;widths&#39;, &#39;use&#39;: &#39;yes&#39;, &#39;tag&#39;: &#39;eeg&#39;}}, &#39;statistical&#39;: {&#39;Absolute energy&#39;: {&#39;complexity&#39;: &#39;log&#39;, &#39;description&#39;: &#39;Computes the absolute energy of the signal.&#39;, &#39;function&#39;: &#39;tsfel.abs_energy&#39;, &#39;parameters&#39;: &#39;&#39;, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;, &#39;tag&#39;: &#39;audio&#39;}, &#39;Average power&#39;: {&#39;complexity&#39;: &#39;constant&#39;, &#39;description&#39;: &#39;Computes the average power of the signal.&#39;, &#39;function&#39;: &#39;tsfel.average_power&#39;, &#39;parameters&#39;: {&#39;fs&#39;: 100}, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;, &#39;tag&#39;: &#39;audio&#39;}, &#39;ECDF&#39;: {&#39;complexity&#39;: &#39;log&#39;, &#39;description&#39;: &#39;Computes the values of ECDF (empirical cumulative distribution function) along the time axis.&#39;, &#39;function&#39;: &#39;tsfel.ecdf&#39;, &#39;parameters&#39;: {&#39;d&#39;: 10}, &#39;n_features&#39;: &#39;d&#39;, &#39;use&#39;: &#39;yes&#39;}, &#39;ECDF Percentile&#39;: {&#39;complexity&#39;: &#39;log&#39;, &#39;description&#39;: &#39;Determines the percentile value of the ECDF.&#39;, &#39;function&#39;: &#39;tsfel.ecdf_percentile&#39;, &#39;parameters&#39;: {&#39;percentile&#39;: &#39;[0.2, 0.8]&#39;}, &#39;n_features&#39;: &#39;percentile&#39;, &#39;use&#39;: &#39;yes&#39;}, &#39;ECDF Percentile Count&#39;: {&#39;complexity&#39;: &#39;log&#39;, &#39;description&#39;: &#39;Determines the cumulative sum of samples that are less than the percentile.&#39;, &#39;function&#39;: &#39;tsfel.ecdf_percentile_count&#39;, &#39;parameters&#39;: {&#39;percentile&#39;: &#39;[0.2, 0.8]&#39;}, &#39;n_features&#39;: &#39;percentile&#39;, &#39;use&#39;: &#39;yes&#39;}, &#39;Entropy&#39;: {&#39;complexity&#39;: &#39;log&#39;, &#39;description&#39;: &#39;Computes the entropy of the signal using the Shannon Entropy.&#39;, &#39;function&#39;: &#39;tsfel.entropy&#39;, &#39;parameters&#39;: {&#39;prob&#39;: &#39;standard&#39;}, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;, &#39;tag&#39;: &#39;eeg&#39;}, &#39;Histogram&#39;: {&#39;complexity&#39;: &#39;log&#39;, &#39;description&#39;: &#39;Computes histogram of the signal.&#39;, &#39;function&#39;: &#39;tsfel.hist&#39;, &#39;parameters&#39;: {&#39;nbins&#39;: 10, &#39;r&#39;: 1}, &#39;n_features&#39;: &#39;nbins&#39;, &#39;use&#39;: &#39;yes&#39;}, &#39;Interquartile range&#39;: {&#39;complexity&#39;: &#39;constant&#39;, &#39;description&#39;: &#39;Computes interquartile range of the signal.&#39;, &#39;function&#39;: &#39;tsfel.interq_range&#39;, &#39;parameters&#39;: &#39;&#39;, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Kurtosis&#39;: {&#39;complexity&#39;: &#39;constant&#39;, &#39;description&#39;: &#39;Computes kurtosis of the signal.&#39;, &#39;function&#39;: &#39;tsfel.kurtosis&#39;, &#39;parameters&#39;: &#39;&#39;, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Max&#39;: {&#39;complexity&#39;: &#39;constant&#39;, &#39;description&#39;: &#39;Computes the maximum value of the signal.&#39;, &#39;function&#39;: &#39;tsfel.calc_max&#39;, &#39;parameters&#39;: &#39;&#39;, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Mean&#39;: {&#39;complexity&#39;: &#39;constant&#39;, &#39;description&#39;: &#39;Computes the mean value of the signal.&#39;, &#39;function&#39;: &#39;tsfel.calc_mean&#39;, &#39;parameters&#39;: &#39;&#39;, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;, &#39;tag&#39;: &#39;inertial&#39;}, &#39;Mean absolute deviation&#39;: {&#39;complexity&#39;: &#39;log&#39;, &#39;description&#39;: &#39;Computes mean absolute deviation of the signal.&#39;, &#39;function&#39;: &#39;tsfel.mean_abs_deviation&#39;, &#39;parameters&#39;: &#39;&#39;, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Median&#39;: {&#39;complexity&#39;: &#39;constant&#39;, &#39;description&#39;: &#39;Computes median of the signal.&#39;, &#39;function&#39;: &#39;tsfel.calc_median&#39;, &#39;parameters&#39;: &#39;&#39;, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Median absolute deviation&#39;: {&#39;complexity&#39;: &#39;constant&#39;, &#39;description&#39;: &#39;Computes median absolute deviation of the signal.&#39;, &#39;function&#39;: &#39;tsfel.median_abs_deviation&#39;, &#39;parameters&#39;: &#39;&#39;, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Min&#39;: {&#39;complexity&#39;: &#39;constant&#39;, &#39;description&#39;: &#39;Computes the minimum value of the signal.&#39;, &#39;function&#39;: &#39;tsfel.calc_min&#39;, &#39;parameters&#39;: &#39;&#39;, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Peak to peak distance&#39;: {&#39;complexity&#39;: &#39;constant&#39;, &#39;description&#39;: &#39;Computes the peak to peak distance.&#39;, &#39;function&#39;: &#39;tsfel.pk_pk_distance&#39;, &#39;parameters&#39;: &#39;&#39;, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Root mean square&#39;: {&#39;complexity&#39;: &#39;constant&#39;, &#39;description&#39;: &#39;Computes root mean square of the signal.&#39;, &#39;function&#39;: &#39;tsfel.rms&#39;, &#39;parameters&#39;: &#39;&#39;, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;, &#39;tag&#39;: [&#39;emg&#39;, &#39;inertial&#39;]}, &#39;Skewness&#39;: {&#39;complexity&#39;: &#39;constant&#39;, &#39;description&#39;: &#39;Computes skewness of the signal.&#39;, &#39;function&#39;: &#39;tsfel.skewness&#39;, &#39;parameters&#39;: &#39;&#39;, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Standard deviation&#39;: {&#39;complexity&#39;: &#39;constant&#39;, &#39;description&#39;: &#39;Computes standard deviation of the signal.&#39;, &#39;function&#39;: &#39;tsfel.calc_std&#39;, &#39;parameters&#39;: &#39;&#39;, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Variance&#39;: {&#39;complexity&#39;: &#39;constant&#39;, &#39;description&#39;: &#39;Computes variance of the signal.&#39;, &#39;function&#39;: &#39;tsfel.calc_var&#39;, &#39;parameters&#39;: &#39;&#39;, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}}, &#39;temporal&#39;: {&#39;Area under the curve&#39;: {&#39;complexity&#39;: &#39;log&#39;, &#39;description&#39;: &#39;Computes the area under the curve of the signal computed with trapezoid rule.&#39;, &#39;function&#39;: &#39;tsfel.auc&#39;, &#39;parameters&#39;: {&#39;fs&#39;: 100}, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Autocorrelation&#39;: {&#39;complexity&#39;: &#39;constant&#39;, &#39;description&#39;: &#39;Computes autocorrelation of the signal.&#39;, &#39;function&#39;: &#39;tsfel.autocorr&#39;, &#39;parameters&#39;: &#39;&#39;, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;, &#39;tag&#39;: &#39;inertial&#39;}, &#39;Centroid&#39;: {&#39;complexity&#39;: &#39;constant&#39;, &#39;description&#39;: &#39;Computes the centroid along the time axis.&#39;, &#39;function&#39;: &#39;tsfel.calc_centroid&#39;, &#39;parameters&#39;: {&#39;fs&#39;: 100}, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Mean absolute diff&#39;: {&#39;complexity&#39;: &#39;constant&#39;, &#39;description&#39;: &#39;Computes mean absolute differences of the signal.&#39;, &#39;function&#39;: &#39;tsfel.mean_abs_diff&#39;, &#39;parameters&#39;: &#39;&#39;, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Mean diff&#39;: {&#39;complexity&#39;: &#39;constant&#39;, &#39;description&#39;: &#39;Computes mean of differences of the signal.&#39;, &#39;function&#39;: &#39;tsfel.mean_diff&#39;, &#39;parameters&#39;: &#39;&#39;, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Median absolute diff&#39;: {&#39;complexity&#39;: &#39;constant&#39;, &#39;description&#39;: &#39;Computes median absolute differences of the signal.&#39;, &#39;function&#39;: &#39;tsfel.median_abs_diff&#39;, &#39;parameters&#39;: &#39;&#39;, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Median diff&#39;: {&#39;complexity&#39;: &#39;constant&#39;, &#39;description&#39;: &#39;Computes median of differences of the signal.&#39;, &#39;function&#39;: &#39;tsfel.median_diff&#39;, &#39;parameters&#39;: &#39;&#39;, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Negative turning points&#39;: {&#39;complexity&#39;: &#39;constant&#39;, &#39;description&#39;: &#39;Computes number of negative turning points of the signal.&#39;, &#39;function&#39;: &#39;tsfel.negative_turning&#39;, &#39;parameters&#39;: &#39;&#39;, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;, &#39;tag&#39;: &#39;emg&#39;}, &#39;Neighbourhood peaks&#39;: {&#39;complexity&#39;: &#39;constant&#39;, &#39;description&#39;: &#39;Computes the number of peaks from a defined neighbourhood of the signal.&#39;, &#39;function&#39;: &#39;tsfel.neighbourhood_peaks&#39;, &#39;parameters&#39;: {&#39;n&#39;: 10}, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Positive turning points&#39;: {&#39;complexity&#39;: &#39;constant&#39;, &#39;description&#39;: &#39;Computes number of positive turning points of the signal.&#39;, &#39;function&#39;: &#39;tsfel.positive_turning&#39;, &#39;parameters&#39;: &#39;&#39;, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;, &#39;tag&#39;: &#39;emg&#39;}, &#39;Signal distance&#39;: {&#39;complexity&#39;: &#39;constant&#39;, &#39;description&#39;: &#39;Computes signal traveled distance.&#39;, &#39;function&#39;: &#39;tsfel.distance&#39;, &#39;parameters&#39;: &#39;&#39;, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Slope&#39;: {&#39;complexity&#39;: &#39;log&#39;, &#39;description&#39;: &#39;Computes the slope of the signal by fitting a linear equation to the observed data.&#39;, &#39;function&#39;: &#39;tsfel.slope&#39;, &#39;parameters&#39;: &#39;&#39;, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Sum absolute diff&#39;: {&#39;complexity&#39;: &#39;constant&#39;, &#39;description&#39;: &#39;Computes sum of absolute differences of the signal.&#39;, &#39;function&#39;: &#39;tsfel.sum_abs_diff&#39;, &#39;parameters&#39;: &#39;&#39;, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;}, &#39;Zero crossing rate&#39;: {&#39;complexity&#39;: &#39;constant&#39;, &#39;description&#39;: &#39;Computes Zero-crossing rate of the signal.&#39;, &#39;function&#39;: &#39;tsfel.zero_cross&#39;, &#39;parameters&#39;: &#39;&#39;, &#39;n_features&#39;: 1, &#39;use&#39;: &#39;yes&#39;, &#39;tag&#39;: [&#39;audio&#39;, &#39;emg&#39;]}}}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;We have a total of </span><span class="si">{</span><span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1"> data sample and each has </span><span class="si">{</span><span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1"> data poins&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>We have a total of 1720 data sample and each has 15001 data poins
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span> <span class="c1">#Z.shape[0]):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Extracting features from sample </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">X</span><span class="o">=</span><span class="n">tsfel</span><span class="o">.</span><span class="n">time_series_features_extractor</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span><span class="n">fs</span><span class="o">=</span><span class="mf">100.</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">X</span><span class="p">[</span><span class="s1">&#39;source_type&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;source_type&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">XX</span> <span class="o">=</span> <span class="n">tsfel</span><span class="o">.</span><span class="n">time_series_features_extractor</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span><span class="n">fs</span><span class="o">=</span><span class="mf">100.</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">XX</span><span class="p">[</span><span class="s1">&#39;source_type&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;source_type&#39;</span><span class="p">]</span>
        <span class="n">X</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">XX</span><span class="p">,</span><span class="n">X</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="c1"># change the column names to remove the prefix 0_</span>
<span class="n">X</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;0_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Extracting features from sample 0/1720
Extracting features from sample 1/1720
Extracting features from sample 2/1720
Extracting features from sample 3/1720
Extracting features from sample 4/1720
Extracting features from sample 5/1720
Extracting features from sample 6/1720
Extracting features from sample 7/1720
Extracting features from sample 8/1720
Extracting features from sample 9/1720
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Absolute energy</th>
      <th>Area under the curve</th>
      <th>Autocorrelation</th>
      <th>Average power</th>
      <th>Centroid</th>
      <th>ECDF Percentile Count_0</th>
      <th>ECDF Percentile Count_1</th>
      <th>ECDF Percentile_0</th>
      <th>ECDF Percentile_1</th>
      <th>ECDF_0</th>
      <th>...</th>
      <th>Wavelet variance_1</th>
      <th>Wavelet variance_2</th>
      <th>Wavelet variance_3</th>
      <th>Wavelet variance_4</th>
      <th>Wavelet variance_5</th>
      <th>Wavelet variance_6</th>
      <th>Wavelet variance_7</th>
      <th>Wavelet variance_8</th>
      <th>Zero crossing rate</th>
      <th>source_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9.742864e+08</td>
      <td>31207.637387</td>
      <td>9.742864e+08</td>
      <td>6.495243e+06</td>
      <td>78.466491</td>
      <td>3000.0</td>
      <td>12000.0</td>
      <td>-298.208729</td>
      <td>151.301746</td>
      <td>0.000067</td>
      <td>...</td>
      <td>1395.348318</td>
      <td>2495.550398</td>
      <td>3674.667437</td>
      <td>5530.106304</td>
      <td>8072.751642</td>
      <td>11149.616998</td>
      <td>14670.487177</td>
      <td>18719.058340</td>
      <td>235.0</td>
      <td>earthquake</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8.402399e+07</td>
      <td>9063.005871</td>
      <td>8.402399e+07</td>
      <td>5.601600e+05</td>
      <td>58.830080</td>
      <td>3000.0</td>
      <td>12000.0</td>
      <td>-77.708776</td>
      <td>48.153323</td>
      <td>0.000067</td>
      <td>...</td>
      <td>921.217046</td>
      <td>1395.363737</td>
      <td>1567.561286</td>
      <td>1256.932809</td>
      <td>880.666612</td>
      <td>682.995650</td>
      <td>637.912389</td>
      <td>674.893518</td>
      <td>272.0</td>
      <td>earthquake</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9.015331e+07</td>
      <td>6910.552647</td>
      <td>9.015331e+07</td>
      <td>6.010221e+05</td>
      <td>63.002674</td>
      <td>3000.0</td>
      <td>12000.0</td>
      <td>-29.206673</td>
      <td>47.147688</td>
      <td>0.000067</td>
      <td>...</td>
      <td>12754.759956</td>
      <td>23536.460101</td>
      <td>26033.368648</td>
      <td>22937.003326</td>
      <td>18408.577823</td>
      <td>14822.361811</td>
      <td>12640.580469</td>
      <td>11471.174193</td>
      <td>1085.0</td>
      <td>earthquake</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7.096144e+08</td>
      <td>24553.426193</td>
      <td>7.096144e+08</td>
      <td>4.730763e+06</td>
      <td>66.389598</td>
      <td>3000.0</td>
      <td>12000.0</td>
      <td>-114.501055</td>
      <td>213.176390</td>
      <td>0.000067</td>
      <td>...</td>
      <td>27267.403246</td>
      <td>55930.185792</td>
      <td>66419.654741</td>
      <td>64470.555161</td>
      <td>60589.434231</td>
      <td>58693.473343</td>
      <td>60371.152906</td>
      <td>66502.811011</td>
      <td>803.0</td>
      <td>earthquake</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9.082897e+08</td>
      <td>28869.941529</td>
      <td>9.082897e+08</td>
      <td>6.055265e+06</td>
      <td>50.864641</td>
      <td>3000.0</td>
      <td>12000.0</td>
      <td>-294.543856</td>
      <td>38.136901</td>
      <td>0.000067</td>
      <td>...</td>
      <td>5822.304317</td>
      <td>10699.777184</td>
      <td>15313.786784</td>
      <td>17756.953569</td>
      <td>18258.559868</td>
      <td>18086.534963</td>
      <td>17987.856997</td>
      <td>18139.370933</td>
      <td>1361.0</td>
      <td>earthquake</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 390 columns</p>
</div></div></div>
</div>
<p>In a general code, you may package this into a function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calculate_features</span><span class="p">(</span><span class="n">Z</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to calculate features from the data</span>
<span class="sd">    Z: 2D array of seismic data data</span>

<span class="sd">    Returns:</span>
<span class="sd">    X: DataFrame of the features</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Extracting features from sample </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">X</span><span class="o">=</span><span class="n">tsfel</span><span class="o">.</span><span class="n">time_series_features_extractor</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span><span class="n">fs</span><span class="o">=</span><span class="mf">100.</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">X</span><span class="p">[</span><span class="s1">&#39;source_type&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;source_type&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">XX</span> <span class="o">=</span> <span class="n">tsfel</span><span class="o">.</span><span class="n">time_series_features_extractor</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span><span class="n">fs</span><span class="o">=</span><span class="mf">100.</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">XX</span><span class="p">[</span><span class="s1">&#39;source_type&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;source_type&#39;</span><span class="p">]</span>
            <span class="n">X</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">XX</span><span class="p">,</span><span class="n">X</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># change the column names to remove the prefix 0_</span>
    <span class="n">X</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;0_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">X</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate features from the seismic data and time it</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">calculate_features</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Time taken to calculate features: </span><span class="si">{</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> seconds&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Extracting features from sample 0/1720
Extracting features from sample 1/1720
Extracting features from sample 2/1720
Extracting features from sample 3/1720
Extracting features from sample 4/1720
Extracting features from sample 5/1720
Extracting features from sample 6/1720
Extracting features from sample 7/1720
Extracting features from sample 8/1720
Extracting features from sample 9/1720
Extracting features from sample 10/1720
Extracting features from sample 11/1720
Extracting features from sample 12/1720
Extracting features from sample 13/1720
Extracting features from sample 14/1720
Extracting features from sample 15/1720
Extracting features from sample 16/1720
Extracting features from sample 17/1720
Extracting features from sample 18/1720
Extracting features from sample 19/1720
Extracting features from sample 20/1720
Extracting features from sample 21/1720
Extracting features from sample 22/1720
Extracting features from sample 23/1720
Extracting features from sample 24/1720
Extracting features from sample 25/1720
Extracting features from sample 26/1720
Extracting features from sample 27/1720
Extracting features from sample 28/1720
Extracting features from sample 29/1720
Extracting features from sample 30/1720
Extracting features from sample 31/1720
Extracting features from sample 32/1720
Extracting features from sample 33/1720
Extracting features from sample 34/1720
Extracting features from sample 35/1720
Extracting features from sample 36/1720
Extracting features from sample 37/1720
Extracting features from sample 38/1720
Extracting features from sample 39/1720
Extracting features from sample 40/1720
Extracting features from sample 41/1720
Extracting features from sample 42/1720
Extracting features from sample 43/1720
Extracting features from sample 44/1720
Extracting features from sample 45/1720
Extracting features from sample 46/1720
Extracting features from sample 47/1720
Extracting features from sample 48/1720
Extracting features from sample 49/1720
Extracting features from sample 50/1720
Extracting features from sample 51/1720
Extracting features from sample 52/1720
Extracting features from sample 53/1720
Extracting features from sample 54/1720
Extracting features from sample 55/1720
Extracting features from sample 56/1720
Extracting features from sample 57/1720
Extracting features from sample 58/1720
Extracting features from sample 59/1720
Extracting features from sample 60/1720
Extracting features from sample 61/1720
Extracting features from sample 62/1720
Extracting features from sample 63/1720
Extracting features from sample 64/1720
Extracting features from sample 65/1720
Extracting features from sample 66/1720
Extracting features from sample 67/1720
Extracting features from sample 68/1720
Extracting features from sample 69/1720
Extracting features from sample 70/1720
Extracting features from sample 71/1720
Extracting features from sample 72/1720
Extracting features from sample 73/1720
Extracting features from sample 74/1720
Extracting features from sample 75/1720
Extracting features from sample 76/1720
Extracting features from sample 77/1720
Extracting features from sample 78/1720
Extracting features from sample 79/1720
Extracting features from sample 80/1720
Extracting features from sample 81/1720
Extracting features from sample 82/1720
Extracting features from sample 83/1720
Extracting features from sample 84/1720
Extracting features from sample 85/1720
Extracting features from sample 86/1720
Extracting features from sample 87/1720
Extracting features from sample 88/1720
Extracting features from sample 89/1720
Extracting features from sample 90/1720
Extracting features from sample 91/1720
Extracting features from sample 92/1720
Extracting features from sample 93/1720
Extracting features from sample 94/1720
Extracting features from sample 95/1720
Extracting features from sample 96/1720
Extracting features from sample 97/1720
Extracting features from sample 98/1720
Extracting features from sample 99/1720
Extracting features from sample 100/1720
Extracting features from sample 101/1720
Extracting features from sample 102/1720
Extracting features from sample 103/1720
Extracting features from sample 104/1720
Extracting features from sample 105/1720
Extracting features from sample 106/1720
Extracting features from sample 107/1720
Extracting features from sample 108/1720
Extracting features from sample 109/1720
Extracting features from sample 110/1720
Extracting features from sample 111/1720
Extracting features from sample 112/1720
Extracting features from sample 113/1720
Extracting features from sample 114/1720
Extracting features from sample 115/1720
Extracting features from sample 116/1720
Extracting features from sample 117/1720
Extracting features from sample 118/1720
Extracting features from sample 119/1720
Extracting features from sample 120/1720
Extracting features from sample 121/1720
Extracting features from sample 122/1720
Extracting features from sample 123/1720
Extracting features from sample 124/1720
Extracting features from sample 125/1720
Extracting features from sample 126/1720
Extracting features from sample 127/1720
Extracting features from sample 128/1720
Extracting features from sample 129/1720
Extracting features from sample 130/1720
Extracting features from sample 131/1720
Extracting features from sample 132/1720
Extracting features from sample 133/1720
Extracting features from sample 134/1720
Extracting features from sample 135/1720
Extracting features from sample 136/1720
Extracting features from sample 137/1720
Extracting features from sample 138/1720
Extracting features from sample 139/1720
Extracting features from sample 140/1720
Extracting features from sample 141/1720
Extracting features from sample 142/1720
Extracting features from sample 143/1720
Extracting features from sample 144/1720
Extracting features from sample 145/1720
Extracting features from sample 146/1720
Extracting features from sample 147/1720
Extracting features from sample 148/1720
Extracting features from sample 149/1720
Extracting features from sample 150/1720
Extracting features from sample 151/1720
Extracting features from sample 152/1720
Extracting features from sample 153/1720
Extracting features from sample 154/1720
Extracting features from sample 155/1720
Extracting features from sample 156/1720
Extracting features from sample 157/1720
Extracting features from sample 158/1720
Extracting features from sample 159/1720
Extracting features from sample 160/1720
Extracting features from sample 161/1720
Extracting features from sample 162/1720
Extracting features from sample 163/1720
Extracting features from sample 164/1720
Extracting features from sample 165/1720
Extracting features from sample 166/1720
Extracting features from sample 167/1720
Extracting features from sample 168/1720
Extracting features from sample 169/1720
Extracting features from sample 170/1720
Extracting features from sample 171/1720
Extracting features from sample 172/1720
Extracting features from sample 173/1720
Extracting features from sample 174/1720
Extracting features from sample 175/1720
Extracting features from sample 176/1720
Extracting features from sample 177/1720
Extracting features from sample 178/1720
Extracting features from sample 179/1720
Extracting features from sample 180/1720
Extracting features from sample 181/1720
Extracting features from sample 182/1720
Extracting features from sample 183/1720
Extracting features from sample 184/1720
Extracting features from sample 185/1720
Extracting features from sample 186/1720
Extracting features from sample 187/1720
Extracting features from sample 188/1720
Extracting features from sample 189/1720
Extracting features from sample 190/1720
Extracting features from sample 191/1720
Extracting features from sample 192/1720
Extracting features from sample 193/1720
Extracting features from sample 194/1720
Extracting features from sample 195/1720
Extracting features from sample 196/1720
Extracting features from sample 197/1720
Extracting features from sample 198/1720
Extracting features from sample 199/1720
Extracting features from sample 200/1720
Extracting features from sample 201/1720
Extracting features from sample 202/1720
Extracting features from sample 203/1720
Extracting features from sample 204/1720
Extracting features from sample 205/1720
Extracting features from sample 206/1720
Extracting features from sample 207/1720
Extracting features from sample 208/1720
Extracting features from sample 209/1720
Extracting features from sample 210/1720
Extracting features from sample 211/1720
Extracting features from sample 212/1720
Extracting features from sample 213/1720
Extracting features from sample 214/1720
Extracting features from sample 215/1720
Extracting features from sample 216/1720
Extracting features from sample 217/1720
Extracting features from sample 218/1720
Extracting features from sample 219/1720
Extracting features from sample 220/1720
Extracting features from sample 221/1720
Extracting features from sample 222/1720
Extracting features from sample 223/1720
Extracting features from sample 224/1720
Extracting features from sample 225/1720
Extracting features from sample 226/1720
Extracting features from sample 227/1720
Extracting features from sample 228/1720
Extracting features from sample 229/1720
Extracting features from sample 230/1720
Extracting features from sample 231/1720
Extracting features from sample 232/1720
Extracting features from sample 233/1720
Extracting features from sample 234/1720
Extracting features from sample 235/1720
Extracting features from sample 236/1720
Extracting features from sample 237/1720
Extracting features from sample 238/1720
Extracting features from sample 239/1720
Extracting features from sample 240/1720
Extracting features from sample 241/1720
Extracting features from sample 242/1720
Extracting features from sample 243/1720
Extracting features from sample 244/1720
Extracting features from sample 245/1720
Extracting features from sample 246/1720
Extracting features from sample 247/1720
Extracting features from sample 248/1720
Extracting features from sample 249/1720
Extracting features from sample 250/1720
Extracting features from sample 251/1720
Extracting features from sample 252/1720
Extracting features from sample 253/1720
Extracting features from sample 254/1720
Extracting features from sample 255/1720
Extracting features from sample 256/1720
Extracting features from sample 257/1720
Extracting features from sample 258/1720
Extracting features from sample 259/1720
Extracting features from sample 260/1720
Extracting features from sample 261/1720
Extracting features from sample 262/1720
Extracting features from sample 263/1720
Extracting features from sample 264/1720
Extracting features from sample 265/1720
Extracting features from sample 266/1720
Extracting features from sample 267/1720
Extracting features from sample 268/1720
Extracting features from sample 269/1720
Extracting features from sample 270/1720
Extracting features from sample 271/1720
Extracting features from sample 272/1720
Extracting features from sample 273/1720
Extracting features from sample 274/1720
Extracting features from sample 275/1720
Extracting features from sample 276/1720
Extracting features from sample 277/1720
Extracting features from sample 278/1720
Extracting features from sample 279/1720
Extracting features from sample 280/1720
Extracting features from sample 281/1720
Extracting features from sample 282/1720
Extracting features from sample 283/1720
Extracting features from sample 284/1720
Extracting features from sample 285/1720
Extracting features from sample 286/1720
Extracting features from sample 287/1720
Extracting features from sample 288/1720
Extracting features from sample 289/1720
Extracting features from sample 290/1720
Extracting features from sample 291/1720
Extracting features from sample 292/1720
Extracting features from sample 293/1720
Extracting features from sample 294/1720
Extracting features from sample 295/1720
Extracting features from sample 296/1720
Extracting features from sample 297/1720
Extracting features from sample 298/1720
Extracting features from sample 299/1720
Extracting features from sample 300/1720
Extracting features from sample 301/1720
Extracting features from sample 302/1720
Extracting features from sample 303/1720
Extracting features from sample 304/1720
Extracting features from sample 305/1720
Extracting features from sample 306/1720
Extracting features from sample 307/1720
Extracting features from sample 308/1720
Extracting features from sample 309/1720
Extracting features from sample 310/1720
Extracting features from sample 311/1720
Extracting features from sample 312/1720
Extracting features from sample 313/1720
Extracting features from sample 314/1720
Extracting features from sample 315/1720
Extracting features from sample 316/1720
Extracting features from sample 317/1720
Extracting features from sample 318/1720
Extracting features from sample 319/1720
Extracting features from sample 320/1720
Extracting features from sample 321/1720
Extracting features from sample 322/1720
Extracting features from sample 323/1720
Extracting features from sample 324/1720
Extracting features from sample 325/1720
Extracting features from sample 326/1720
Extracting features from sample 327/1720
Extracting features from sample 328/1720
Extracting features from sample 329/1720
Extracting features from sample 330/1720
Extracting features from sample 331/1720
Extracting features from sample 332/1720
Extracting features from sample 333/1720
Extracting features from sample 334/1720
Extracting features from sample 335/1720
Extracting features from sample 336/1720
Extracting features from sample 337/1720
Extracting features from sample 338/1720
Extracting features from sample 339/1720
Extracting features from sample 340/1720
Extracting features from sample 341/1720
Extracting features from sample 342/1720
Extracting features from sample 343/1720
Extracting features from sample 344/1720
Extracting features from sample 345/1720
Extracting features from sample 346/1720
Extracting features from sample 347/1720
Extracting features from sample 348/1720
Extracting features from sample 349/1720
Extracting features from sample 350/1720
Extracting features from sample 351/1720
Extracting features from sample 352/1720
Extracting features from sample 353/1720
Extracting features from sample 354/1720
Extracting features from sample 355/1720
Extracting features from sample 356/1720
Extracting features from sample 357/1720
Extracting features from sample 358/1720
Extracting features from sample 359/1720
Extracting features from sample 360/1720
Extracting features from sample 361/1720
Extracting features from sample 362/1720
Extracting features from sample 363/1720
Extracting features from sample 364/1720
Extracting features from sample 365/1720
Extracting features from sample 366/1720
Extracting features from sample 367/1720
Extracting features from sample 368/1720
Extracting features from sample 369/1720
Extracting features from sample 370/1720
Extracting features from sample 371/1720
Extracting features from sample 372/1720
Extracting features from sample 373/1720
Extracting features from sample 374/1720
Extracting features from sample 375/1720
Extracting features from sample 376/1720
Extracting features from sample 377/1720
Extracting features from sample 378/1720
Extracting features from sample 379/1720
Extracting features from sample 380/1720
Extracting features from sample 381/1720
Extracting features from sample 382/1720
Extracting features from sample 383/1720
Extracting features from sample 384/1720
Extracting features from sample 385/1720
Extracting features from sample 386/1720
Extracting features from sample 387/1720
Extracting features from sample 388/1720
Extracting features from sample 389/1720
Extracting features from sample 390/1720
Extracting features from sample 391/1720
Extracting features from sample 392/1720
Extracting features from sample 393/1720
Extracting features from sample 394/1720
Extracting features from sample 395/1720
Extracting features from sample 396/1720
Extracting features from sample 397/1720
Extracting features from sample 398/1720
Extracting features from sample 399/1720
Extracting features from sample 400/1720
Extracting features from sample 401/1720
Extracting features from sample 402/1720
Extracting features from sample 403/1720
Extracting features from sample 404/1720
Extracting features from sample 405/1720
Extracting features from sample 406/1720
Extracting features from sample 407/1720
Extracting features from sample 408/1720
Extracting features from sample 409/1720
Extracting features from sample 410/1720
Extracting features from sample 411/1720
Extracting features from sample 412/1720
Extracting features from sample 413/1720
Extracting features from sample 414/1720
Extracting features from sample 415/1720
Extracting features from sample 416/1720
Extracting features from sample 417/1720
Extracting features from sample 418/1720
Extracting features from sample 419/1720
Extracting features from sample 420/1720
Extracting features from sample 421/1720
Extracting features from sample 422/1720
Extracting features from sample 423/1720
Extracting features from sample 424/1720
Extracting features from sample 425/1720
Extracting features from sample 426/1720
Extracting features from sample 427/1720
Extracting features from sample 428/1720
Extracting features from sample 429/1720
Extracting features from sample 430/1720
Extracting features from sample 431/1720
Extracting features from sample 432/1720
Extracting features from sample 433/1720
Extracting features from sample 434/1720
Extracting features from sample 435/1720
Extracting features from sample 436/1720
Extracting features from sample 437/1720
Extracting features from sample 438/1720
Extracting features from sample 439/1720
Extracting features from sample 440/1720
Extracting features from sample 441/1720
Extracting features from sample 442/1720
Extracting features from sample 443/1720
Extracting features from sample 444/1720
Extracting features from sample 445/1720
Extracting features from sample 446/1720
Extracting features from sample 447/1720
Extracting features from sample 448/1720
Extracting features from sample 449/1720
Extracting features from sample 450/1720
Extracting features from sample 451/1720
Extracting features from sample 452/1720
Extracting features from sample 453/1720
Extracting features from sample 454/1720
Extracting features from sample 455/1720
Extracting features from sample 456/1720
Extracting features from sample 457/1720
Extracting features from sample 458/1720
Extracting features from sample 459/1720
Extracting features from sample 460/1720
Extracting features from sample 461/1720
Extracting features from sample 462/1720
Extracting features from sample 463/1720
Extracting features from sample 464/1720
Extracting features from sample 465/1720
Extracting features from sample 466/1720
Extracting features from sample 467/1720
Extracting features from sample 468/1720
Extracting features from sample 469/1720
Extracting features from sample 470/1720
Extracting features from sample 471/1720
Extracting features from sample 472/1720
Extracting features from sample 473/1720
Extracting features from sample 474/1720
Extracting features from sample 475/1720
Extracting features from sample 476/1720
Extracting features from sample 477/1720
Extracting features from sample 478/1720
Extracting features from sample 479/1720
Extracting features from sample 480/1720
Extracting features from sample 481/1720
Extracting features from sample 482/1720
Extracting features from sample 483/1720
Extracting features from sample 484/1720
Extracting features from sample 485/1720
Extracting features from sample 486/1720
Extracting features from sample 487/1720
Extracting features from sample 488/1720
Extracting features from sample 489/1720
Extracting features from sample 490/1720
Extracting features from sample 491/1720
Extracting features from sample 492/1720
Extracting features from sample 493/1720
Extracting features from sample 494/1720
Extracting features from sample 495/1720
Extracting features from sample 496/1720
Extracting features from sample 497/1720
Extracting features from sample 498/1720
Extracting features from sample 499/1720
Extracting features from sample 500/1720
Extracting features from sample 501/1720
Extracting features from sample 502/1720
Extracting features from sample 503/1720
Extracting features from sample 504/1720
Extracting features from sample 505/1720
Extracting features from sample 506/1720
Extracting features from sample 507/1720
Extracting features from sample 508/1720
Extracting features from sample 509/1720
Extracting features from sample 510/1720
Extracting features from sample 511/1720
Extracting features from sample 512/1720
Extracting features from sample 513/1720
Extracting features from sample 514/1720
Extracting features from sample 515/1720
Extracting features from sample 516/1720
Extracting features from sample 517/1720
Extracting features from sample 518/1720
Extracting features from sample 519/1720
Extracting features from sample 520/1720
Extracting features from sample 521/1720
Extracting features from sample 522/1720
Extracting features from sample 523/1720
Extracting features from sample 524/1720
Extracting features from sample 525/1720
Extracting features from sample 526/1720
Extracting features from sample 527/1720
Extracting features from sample 528/1720
Extracting features from sample 529/1720
Extracting features from sample 530/1720
Extracting features from sample 531/1720
Extracting features from sample 532/1720
Extracting features from sample 533/1720
Extracting features from sample 534/1720
Extracting features from sample 535/1720
Extracting features from sample 536/1720
Extracting features from sample 537/1720
Extracting features from sample 538/1720
Extracting features from sample 539/1720
Extracting features from sample 540/1720
Extracting features from sample 541/1720
Extracting features from sample 542/1720
Extracting features from sample 543/1720
Extracting features from sample 544/1720
Extracting features from sample 545/1720
Extracting features from sample 546/1720
Extracting features from sample 547/1720
Extracting features from sample 548/1720
Extracting features from sample 549/1720
Extracting features from sample 550/1720
Extracting features from sample 551/1720
Extracting features from sample 552/1720
Extracting features from sample 553/1720
Extracting features from sample 554/1720
Extracting features from sample 555/1720
Extracting features from sample 556/1720
Extracting features from sample 557/1720
Extracting features from sample 558/1720
Extracting features from sample 559/1720
Extracting features from sample 560/1720
Extracting features from sample 561/1720
Extracting features from sample 562/1720
Extracting features from sample 563/1720
Extracting features from sample 564/1720
Extracting features from sample 565/1720
Extracting features from sample 566/1720
Extracting features from sample 567/1720
Extracting features from sample 568/1720
Extracting features from sample 569/1720
Extracting features from sample 570/1720
Extracting features from sample 571/1720
Extracting features from sample 572/1720
Extracting features from sample 573/1720
Extracting features from sample 574/1720
Extracting features from sample 575/1720
Extracting features from sample 576/1720
Extracting features from sample 577/1720
Extracting features from sample 578/1720
Extracting features from sample 579/1720
Extracting features from sample 580/1720
Extracting features from sample 581/1720
Extracting features from sample 582/1720
Extracting features from sample 583/1720
Extracting features from sample 584/1720
Extracting features from sample 585/1720
Extracting features from sample 586/1720
Extracting features from sample 587/1720
Extracting features from sample 588/1720
Extracting features from sample 589/1720
Extracting features from sample 590/1720
Extracting features from sample 591/1720
Extracting features from sample 592/1720
Extracting features from sample 593/1720
Extracting features from sample 594/1720
Extracting features from sample 595/1720
Extracting features from sample 596/1720
Extracting features from sample 597/1720
Extracting features from sample 598/1720
Extracting features from sample 599/1720
Extracting features from sample 600/1720
Extracting features from sample 601/1720
Extracting features from sample 602/1720
Extracting features from sample 603/1720
Extracting features from sample 604/1720
Extracting features from sample 605/1720
Extracting features from sample 606/1720
Extracting features from sample 607/1720
Extracting features from sample 608/1720
Extracting features from sample 609/1720
Extracting features from sample 610/1720
Extracting features from sample 611/1720
Extracting features from sample 612/1720
Extracting features from sample 613/1720
Extracting features from sample 614/1720
Extracting features from sample 615/1720
Extracting features from sample 616/1720
Extracting features from sample 617/1720
Extracting features from sample 618/1720
Extracting features from sample 619/1720
Extracting features from sample 620/1720
Extracting features from sample 621/1720
Extracting features from sample 622/1720
Extracting features from sample 623/1720
Extracting features from sample 624/1720
Extracting features from sample 625/1720
Extracting features from sample 626/1720
Extracting features from sample 627/1720
Extracting features from sample 628/1720
Extracting features from sample 629/1720
Extracting features from sample 630/1720
Extracting features from sample 631/1720
Extracting features from sample 632/1720
Extracting features from sample 633/1720
Extracting features from sample 634/1720
Extracting features from sample 635/1720
Extracting features from sample 636/1720
Extracting features from sample 637/1720
Extracting features from sample 638/1720
Extracting features from sample 639/1720
Extracting features from sample 640/1720
Extracting features from sample 641/1720
Extracting features from sample 642/1720
Extracting features from sample 643/1720
Extracting features from sample 644/1720
Extracting features from sample 645/1720
Extracting features from sample 646/1720
Extracting features from sample 647/1720
Extracting features from sample 648/1720
Extracting features from sample 649/1720
Extracting features from sample 650/1720
Extracting features from sample 651/1720
Extracting features from sample 652/1720
Extracting features from sample 653/1720
Extracting features from sample 654/1720
Extracting features from sample 655/1720
Extracting features from sample 656/1720
Extracting features from sample 657/1720
Extracting features from sample 658/1720
Extracting features from sample 659/1720
Extracting features from sample 660/1720
Extracting features from sample 661/1720
Extracting features from sample 662/1720
Extracting features from sample 663/1720
Extracting features from sample 664/1720
Extracting features from sample 665/1720
Extracting features from sample 666/1720
Extracting features from sample 667/1720
Extracting features from sample 668/1720
Extracting features from sample 669/1720
Extracting features from sample 670/1720
Extracting features from sample 671/1720
Extracting features from sample 672/1720
Extracting features from sample 673/1720
Extracting features from sample 674/1720
Extracting features from sample 675/1720
Extracting features from sample 676/1720
Extracting features from sample 677/1720
Extracting features from sample 678/1720
Extracting features from sample 679/1720
Extracting features from sample 680/1720
Extracting features from sample 681/1720
Extracting features from sample 682/1720
Extracting features from sample 683/1720
Extracting features from sample 684/1720
Extracting features from sample 685/1720
Extracting features from sample 686/1720
Extracting features from sample 687/1720
Extracting features from sample 688/1720
Extracting features from sample 689/1720
Extracting features from sample 690/1720
Extracting features from sample 691/1720
Extracting features from sample 692/1720
Extracting features from sample 693/1720
Extracting features from sample 694/1720
Extracting features from sample 695/1720
Extracting features from sample 696/1720
Extracting features from sample 697/1720
Extracting features from sample 698/1720
Extracting features from sample 699/1720
Extracting features from sample 700/1720
Extracting features from sample 701/1720
Extracting features from sample 702/1720
Extracting features from sample 703/1720
Extracting features from sample 704/1720
Extracting features from sample 705/1720
Extracting features from sample 706/1720
Extracting features from sample 707/1720
Extracting features from sample 708/1720
Extracting features from sample 709/1720
Extracting features from sample 710/1720
Extracting features from sample 711/1720
Extracting features from sample 712/1720
Extracting features from sample 713/1720
Extracting features from sample 714/1720
Extracting features from sample 715/1720
Extracting features from sample 716/1720
Extracting features from sample 717/1720
Extracting features from sample 718/1720
Extracting features from sample 719/1720
Extracting features from sample 720/1720
Extracting features from sample 721/1720
Extracting features from sample 722/1720
Extracting features from sample 723/1720
Extracting features from sample 724/1720
Extracting features from sample 725/1720
Extracting features from sample 726/1720
Extracting features from sample 727/1720
Extracting features from sample 728/1720
Extracting features from sample 729/1720
Extracting features from sample 730/1720
Extracting features from sample 731/1720
Extracting features from sample 732/1720
Extracting features from sample 733/1720
Extracting features from sample 734/1720
Extracting features from sample 735/1720
Extracting features from sample 736/1720
Extracting features from sample 737/1720
Extracting features from sample 738/1720
Extracting features from sample 739/1720
Extracting features from sample 740/1720
Extracting features from sample 741/1720
Extracting features from sample 742/1720
Extracting features from sample 743/1720
Extracting features from sample 744/1720
Extracting features from sample 745/1720
Extracting features from sample 746/1720
Extracting features from sample 747/1720
Extracting features from sample 748/1720
Extracting features from sample 749/1720
Extracting features from sample 750/1720
Extracting features from sample 751/1720
Extracting features from sample 752/1720
Extracting features from sample 753/1720
Extracting features from sample 754/1720
Extracting features from sample 755/1720
Extracting features from sample 756/1720
Extracting features from sample 757/1720
Extracting features from sample 758/1720
Extracting features from sample 759/1720
Extracting features from sample 760/1720
Extracting features from sample 761/1720
Extracting features from sample 762/1720
Extracting features from sample 763/1720
Extracting features from sample 764/1720
Extracting features from sample 765/1720
Extracting features from sample 766/1720
Extracting features from sample 767/1720
Extracting features from sample 768/1720
Extracting features from sample 769/1720
Extracting features from sample 770/1720
Extracting features from sample 771/1720
Extracting features from sample 772/1720
Extracting features from sample 773/1720
Extracting features from sample 774/1720
Extracting features from sample 775/1720
Extracting features from sample 776/1720
Extracting features from sample 777/1720
Extracting features from sample 778/1720
Extracting features from sample 779/1720
Extracting features from sample 780/1720
Extracting features from sample 781/1720
Extracting features from sample 782/1720
Extracting features from sample 783/1720
Extracting features from sample 784/1720
Extracting features from sample 785/1720
Extracting features from sample 786/1720
Extracting features from sample 787/1720
Extracting features from sample 788/1720
Extracting features from sample 789/1720
Extracting features from sample 790/1720
Extracting features from sample 791/1720
Extracting features from sample 792/1720
Extracting features from sample 793/1720
Extracting features from sample 794/1720
Extracting features from sample 795/1720
Extracting features from sample 796/1720
Extracting features from sample 797/1720
Extracting features from sample 798/1720
Extracting features from sample 799/1720
Extracting features from sample 800/1720
Extracting features from sample 801/1720
Extracting features from sample 802/1720
Extracting features from sample 803/1720
Extracting features from sample 804/1720
Extracting features from sample 805/1720
Extracting features from sample 806/1720
Extracting features from sample 807/1720
Extracting features from sample 808/1720
Extracting features from sample 809/1720
Extracting features from sample 810/1720
Extracting features from sample 811/1720
Extracting features from sample 812/1720
Extracting features from sample 813/1720
Extracting features from sample 814/1720
Extracting features from sample 815/1720
Extracting features from sample 816/1720
Extracting features from sample 817/1720
Extracting features from sample 818/1720
Extracting features from sample 819/1720
Extracting features from sample 820/1720
Extracting features from sample 821/1720
Extracting features from sample 822/1720
Extracting features from sample 823/1720
Extracting features from sample 824/1720
Extracting features from sample 825/1720
Extracting features from sample 826/1720
Extracting features from sample 827/1720
Extracting features from sample 828/1720
Extracting features from sample 829/1720
Extracting features from sample 830/1720
Extracting features from sample 831/1720
Extracting features from sample 832/1720
Extracting features from sample 833/1720
Extracting features from sample 834/1720
Extracting features from sample 835/1720
Extracting features from sample 836/1720
Extracting features from sample 837/1720
Extracting features from sample 838/1720
Extracting features from sample 839/1720
Extracting features from sample 840/1720
Extracting features from sample 841/1720
Extracting features from sample 842/1720
Extracting features from sample 843/1720
Extracting features from sample 844/1720
Extracting features from sample 845/1720
Extracting features from sample 846/1720
Extracting features from sample 847/1720
Extracting features from sample 848/1720
Extracting features from sample 849/1720
Extracting features from sample 850/1720
Extracting features from sample 851/1720
Extracting features from sample 852/1720
Extracting features from sample 853/1720
Extracting features from sample 854/1720
Extracting features from sample 855/1720
Extracting features from sample 856/1720
Extracting features from sample 857/1720
Extracting features from sample 858/1720
Extracting features from sample 859/1720
Extracting features from sample 860/1720
Extracting features from sample 861/1720
Extracting features from sample 862/1720
Extracting features from sample 863/1720
Extracting features from sample 864/1720
Extracting features from sample 865/1720
Extracting features from sample 866/1720
Extracting features from sample 867/1720
Extracting features from sample 868/1720
Extracting features from sample 869/1720
Extracting features from sample 870/1720
Extracting features from sample 871/1720
Extracting features from sample 872/1720
Extracting features from sample 873/1720
Extracting features from sample 874/1720
Extracting features from sample 875/1720
Extracting features from sample 876/1720
Extracting features from sample 877/1720
Extracting features from sample 878/1720
Extracting features from sample 879/1720
Extracting features from sample 880/1720
Extracting features from sample 881/1720
Extracting features from sample 882/1720
Extracting features from sample 883/1720
Extracting features from sample 884/1720
Extracting features from sample 885/1720
Extracting features from sample 886/1720
Extracting features from sample 887/1720
Extracting features from sample 888/1720
Extracting features from sample 889/1720
Extracting features from sample 890/1720
Extracting features from sample 891/1720
Extracting features from sample 892/1720
Extracting features from sample 893/1720
Extracting features from sample 894/1720
Extracting features from sample 895/1720
Extracting features from sample 896/1720
Extracting features from sample 897/1720
Extracting features from sample 898/1720
Extracting features from sample 899/1720
Extracting features from sample 900/1720
Extracting features from sample 901/1720
Extracting features from sample 902/1720
Extracting features from sample 903/1720
Extracting features from sample 904/1720
Extracting features from sample 905/1720
Extracting features from sample 906/1720
Extracting features from sample 907/1720
Extracting features from sample 908/1720
Extracting features from sample 909/1720
Extracting features from sample 910/1720
Extracting features from sample 911/1720
Extracting features from sample 912/1720
Extracting features from sample 913/1720
Extracting features from sample 914/1720
Extracting features from sample 915/1720
Extracting features from sample 916/1720
Extracting features from sample 917/1720
Extracting features from sample 918/1720
Extracting features from sample 919/1720
Extracting features from sample 920/1720
Extracting features from sample 921/1720
Extracting features from sample 922/1720
Extracting features from sample 923/1720
Extracting features from sample 924/1720
Extracting features from sample 925/1720
Extracting features from sample 926/1720
Extracting features from sample 927/1720
Extracting features from sample 928/1720
Extracting features from sample 929/1720
Extracting features from sample 930/1720
Extracting features from sample 931/1720
Extracting features from sample 932/1720
Extracting features from sample 933/1720
Extracting features from sample 934/1720
Extracting features from sample 935/1720
Extracting features from sample 936/1720
Extracting features from sample 937/1720
Extracting features from sample 938/1720
Extracting features from sample 939/1720
Extracting features from sample 940/1720
Extracting features from sample 941/1720
Extracting features from sample 942/1720
Extracting features from sample 943/1720
Extracting features from sample 944/1720
Extracting features from sample 945/1720
Extracting features from sample 946/1720
Extracting features from sample 947/1720
Extracting features from sample 948/1720
Extracting features from sample 949/1720
Extracting features from sample 950/1720
Extracting features from sample 951/1720
Extracting features from sample 952/1720
Extracting features from sample 953/1720
Extracting features from sample 954/1720
Extracting features from sample 955/1720
Extracting features from sample 956/1720
Extracting features from sample 957/1720
Extracting features from sample 958/1720
Extracting features from sample 959/1720
Extracting features from sample 960/1720
Extracting features from sample 961/1720
Extracting features from sample 962/1720
Extracting features from sample 963/1720
Extracting features from sample 964/1720
Extracting features from sample 965/1720
Extracting features from sample 966/1720
Extracting features from sample 967/1720
Extracting features from sample 968/1720
Extracting features from sample 969/1720
Extracting features from sample 970/1720
Extracting features from sample 971/1720
Extracting features from sample 972/1720
Extracting features from sample 973/1720
Extracting features from sample 974/1720
Extracting features from sample 975/1720
Extracting features from sample 976/1720
Extracting features from sample 977/1720
Extracting features from sample 978/1720
Extracting features from sample 979/1720
Extracting features from sample 980/1720
Extracting features from sample 981/1720
Extracting features from sample 982/1720
Extracting features from sample 983/1720
Extracting features from sample 984/1720
Extracting features from sample 985/1720
Extracting features from sample 986/1720
Extracting features from sample 987/1720
Extracting features from sample 988/1720
Extracting features from sample 989/1720
Extracting features from sample 990/1720
Extracting features from sample 991/1720
Extracting features from sample 992/1720
Extracting features from sample 993/1720
Extracting features from sample 994/1720
Extracting features from sample 995/1720
Extracting features from sample 996/1720
Extracting features from sample 997/1720
Extracting features from sample 998/1720
Extracting features from sample 999/1720
Extracting features from sample 1000/1720
Extracting features from sample 1001/1720
Extracting features from sample 1002/1720
Extracting features from sample 1003/1720
Extracting features from sample 1004/1720
Extracting features from sample 1005/1720
Extracting features from sample 1006/1720
Extracting features from sample 1007/1720
Extracting features from sample 1008/1720
Extracting features from sample 1009/1720
Extracting features from sample 1010/1720
Extracting features from sample 1011/1720
Extracting features from sample 1012/1720
Extracting features from sample 1013/1720
Extracting features from sample 1014/1720
Extracting features from sample 1015/1720
Extracting features from sample 1016/1720
Extracting features from sample 1017/1720
Extracting features from sample 1018/1720
Extracting features from sample 1019/1720
Extracting features from sample 1020/1720
Extracting features from sample 1021/1720
Extracting features from sample 1022/1720
Extracting features from sample 1023/1720
Extracting features from sample 1024/1720
Extracting features from sample 1025/1720
Extracting features from sample 1026/1720
Extracting features from sample 1027/1720
Extracting features from sample 1028/1720
Extracting features from sample 1029/1720
Extracting features from sample 1030/1720
Extracting features from sample 1031/1720
Extracting features from sample 1032/1720
Extracting features from sample 1033/1720
Extracting features from sample 1034/1720
Extracting features from sample 1035/1720
Extracting features from sample 1036/1720
Extracting features from sample 1037/1720
Extracting features from sample 1038/1720
Extracting features from sample 1039/1720
Extracting features from sample 1040/1720
Extracting features from sample 1041/1720
Extracting features from sample 1042/1720
Extracting features from sample 1043/1720
Extracting features from sample 1044/1720
Extracting features from sample 1045/1720
Extracting features from sample 1046/1720
Extracting features from sample 1047/1720
Extracting features from sample 1048/1720
Extracting features from sample 1049/1720
Extracting features from sample 1050/1720
Extracting features from sample 1051/1720
Extracting features from sample 1052/1720
Extracting features from sample 1053/1720
Extracting features from sample 1054/1720
Extracting features from sample 1055/1720
Extracting features from sample 1056/1720
Extracting features from sample 1057/1720
Extracting features from sample 1058/1720
Extracting features from sample 1059/1720
Extracting features from sample 1060/1720
Extracting features from sample 1061/1720
Extracting features from sample 1062/1720
Extracting features from sample 1063/1720
Extracting features from sample 1064/1720
Extracting features from sample 1065/1720
Extracting features from sample 1066/1720
Extracting features from sample 1067/1720
Extracting features from sample 1068/1720
Extracting features from sample 1069/1720
Extracting features from sample 1070/1720
Extracting features from sample 1071/1720
Extracting features from sample 1072/1720
Extracting features from sample 1073/1720
Extracting features from sample 1074/1720
Extracting features from sample 1075/1720
Extracting features from sample 1076/1720
Extracting features from sample 1077/1720
Extracting features from sample 1078/1720
Extracting features from sample 1079/1720
Extracting features from sample 1080/1720
Extracting features from sample 1081/1720
Extracting features from sample 1082/1720
Extracting features from sample 1083/1720
Extracting features from sample 1084/1720
Extracting features from sample 1085/1720
Extracting features from sample 1086/1720
Extracting features from sample 1087/1720
Extracting features from sample 1088/1720
Extracting features from sample 1089/1720
Extracting features from sample 1090/1720
Extracting features from sample 1091/1720
Extracting features from sample 1092/1720
Extracting features from sample 1093/1720
Extracting features from sample 1094/1720
Extracting features from sample 1095/1720
Extracting features from sample 1096/1720
Extracting features from sample 1097/1720
Extracting features from sample 1098/1720
Extracting features from sample 1099/1720
Extracting features from sample 1100/1720
Extracting features from sample 1101/1720
Extracting features from sample 1102/1720
Extracting features from sample 1103/1720
Extracting features from sample 1104/1720
Extracting features from sample 1105/1720
Extracting features from sample 1106/1720
Extracting features from sample 1107/1720
Extracting features from sample 1108/1720
Extracting features from sample 1109/1720
Extracting features from sample 1110/1720
Extracting features from sample 1111/1720
Extracting features from sample 1112/1720
Extracting features from sample 1113/1720
Extracting features from sample 1114/1720
Extracting features from sample 1115/1720
Extracting features from sample 1116/1720
Extracting features from sample 1117/1720
Extracting features from sample 1118/1720
Extracting features from sample 1119/1720
Extracting features from sample 1120/1720
Extracting features from sample 1121/1720
Extracting features from sample 1122/1720
Extracting features from sample 1123/1720
Extracting features from sample 1124/1720
Extracting features from sample 1125/1720
Extracting features from sample 1126/1720
Extracting features from sample 1127/1720
Extracting features from sample 1128/1720
Extracting features from sample 1129/1720
Extracting features from sample 1130/1720
Extracting features from sample 1131/1720
Extracting features from sample 1132/1720
Extracting features from sample 1133/1720
Extracting features from sample 1134/1720
Extracting features from sample 1135/1720
Extracting features from sample 1136/1720
Extracting features from sample 1137/1720
Extracting features from sample 1138/1720
Extracting features from sample 1139/1720
Extracting features from sample 1140/1720
Extracting features from sample 1141/1720
Extracting features from sample 1142/1720
Extracting features from sample 1143/1720
Extracting features from sample 1144/1720
Extracting features from sample 1145/1720
Extracting features from sample 1146/1720
Extracting features from sample 1147/1720
Extracting features from sample 1148/1720
Extracting features from sample 1149/1720
Extracting features from sample 1150/1720
Extracting features from sample 1151/1720
Extracting features from sample 1152/1720
Extracting features from sample 1153/1720
Extracting features from sample 1154/1720
Extracting features from sample 1155/1720
Extracting features from sample 1156/1720
Extracting features from sample 1157/1720
Extracting features from sample 1158/1720
Extracting features from sample 1159/1720
Extracting features from sample 1160/1720
Extracting features from sample 1161/1720
Extracting features from sample 1162/1720
Extracting features from sample 1163/1720
Extracting features from sample 1164/1720
Extracting features from sample 1165/1720
Extracting features from sample 1166/1720
Extracting features from sample 1167/1720
Extracting features from sample 1168/1720
Extracting features from sample 1169/1720
Extracting features from sample 1170/1720
Extracting features from sample 1171/1720
Extracting features from sample 1172/1720
Extracting features from sample 1173/1720
Extracting features from sample 1174/1720
Extracting features from sample 1175/1720
Extracting features from sample 1176/1720
Extracting features from sample 1177/1720
Extracting features from sample 1178/1720
Extracting features from sample 1179/1720
Extracting features from sample 1180/1720
Extracting features from sample 1181/1720
Extracting features from sample 1182/1720
Extracting features from sample 1183/1720
Extracting features from sample 1184/1720
Extracting features from sample 1185/1720
Extracting features from sample 1186/1720
Extracting features from sample 1187/1720
Extracting features from sample 1188/1720
Extracting features from sample 1189/1720
Extracting features from sample 1190/1720
Extracting features from sample 1191/1720
Extracting features from sample 1192/1720
Extracting features from sample 1193/1720
Extracting features from sample 1194/1720
Extracting features from sample 1195/1720
Extracting features from sample 1196/1720
Extracting features from sample 1197/1720
Extracting features from sample 1198/1720
Extracting features from sample 1199/1720
Extracting features from sample 1200/1720
Extracting features from sample 1201/1720
Extracting features from sample 1202/1720
Extracting features from sample 1203/1720
Extracting features from sample 1204/1720
Extracting features from sample 1205/1720
Extracting features from sample 1206/1720
Extracting features from sample 1207/1720
Extracting features from sample 1208/1720
Extracting features from sample 1209/1720
Extracting features from sample 1210/1720
Extracting features from sample 1211/1720
Extracting features from sample 1212/1720
Extracting features from sample 1213/1720
Extracting features from sample 1214/1720
Extracting features from sample 1215/1720
Extracting features from sample 1216/1720
Extracting features from sample 1217/1720
Extracting features from sample 1218/1720
Extracting features from sample 1219/1720
Extracting features from sample 1220/1720
Extracting features from sample 1221/1720
Extracting features from sample 1222/1720
Extracting features from sample 1223/1720
Extracting features from sample 1224/1720
Extracting features from sample 1225/1720
Extracting features from sample 1226/1720
Extracting features from sample 1227/1720
Extracting features from sample 1228/1720
Extracting features from sample 1229/1720
Extracting features from sample 1230/1720
Extracting features from sample 1231/1720
Extracting features from sample 1232/1720
Extracting features from sample 1233/1720
Extracting features from sample 1234/1720
Extracting features from sample 1235/1720
Extracting features from sample 1236/1720
Extracting features from sample 1237/1720
Extracting features from sample 1238/1720
Extracting features from sample 1239/1720
Extracting features from sample 1240/1720
Extracting features from sample 1241/1720
Extracting features from sample 1242/1720
Extracting features from sample 1243/1720
Extracting features from sample 1244/1720
Extracting features from sample 1245/1720
Extracting features from sample 1246/1720
Extracting features from sample 1247/1720
Extracting features from sample 1248/1720
Extracting features from sample 1249/1720
Extracting features from sample 1250/1720
Extracting features from sample 1251/1720
Extracting features from sample 1252/1720
Extracting features from sample 1253/1720
Extracting features from sample 1254/1720
Extracting features from sample 1255/1720
Extracting features from sample 1256/1720
Extracting features from sample 1257/1720
Extracting features from sample 1258/1720
Extracting features from sample 1259/1720
Extracting features from sample 1260/1720
Extracting features from sample 1261/1720
Extracting features from sample 1262/1720
Extracting features from sample 1263/1720
Extracting features from sample 1264/1720
Extracting features from sample 1265/1720
Extracting features from sample 1266/1720
Extracting features from sample 1267/1720
Extracting features from sample 1268/1720
Extracting features from sample 1269/1720
Extracting features from sample 1270/1720
Extracting features from sample 1271/1720
Extracting features from sample 1272/1720
Extracting features from sample 1273/1720
Extracting features from sample 1274/1720
Extracting features from sample 1275/1720
Extracting features from sample 1276/1720
Extracting features from sample 1277/1720
Extracting features from sample 1278/1720
Extracting features from sample 1279/1720
Extracting features from sample 1280/1720
Extracting features from sample 1281/1720
Extracting features from sample 1282/1720
Extracting features from sample 1283/1720
Extracting features from sample 1284/1720
Extracting features from sample 1285/1720
Extracting features from sample 1286/1720
Extracting features from sample 1287/1720
Extracting features from sample 1288/1720
Extracting features from sample 1289/1720
Extracting features from sample 1290/1720
Extracting features from sample 1291/1720
Extracting features from sample 1292/1720
Extracting features from sample 1293/1720
Extracting features from sample 1294/1720
Extracting features from sample 1295/1720
Extracting features from sample 1296/1720
Extracting features from sample 1297/1720
Extracting features from sample 1298/1720
Extracting features from sample 1299/1720
Extracting features from sample 1300/1720
Extracting features from sample 1301/1720
Extracting features from sample 1302/1720
Extracting features from sample 1303/1720
Extracting features from sample 1304/1720
Extracting features from sample 1305/1720
Extracting features from sample 1306/1720
Extracting features from sample 1307/1720
Extracting features from sample 1308/1720
Extracting features from sample 1309/1720
Extracting features from sample 1310/1720
Extracting features from sample 1311/1720
Extracting features from sample 1312/1720
Extracting features from sample 1313/1720
Extracting features from sample 1314/1720
Extracting features from sample 1315/1720
Extracting features from sample 1316/1720
Extracting features from sample 1317/1720
Extracting features from sample 1318/1720
Extracting features from sample 1319/1720
Extracting features from sample 1320/1720
Extracting features from sample 1321/1720
Extracting features from sample 1322/1720
Extracting features from sample 1323/1720
Extracting features from sample 1324/1720
Extracting features from sample 1325/1720
Extracting features from sample 1326/1720
Extracting features from sample 1327/1720
Extracting features from sample 1328/1720
Extracting features from sample 1329/1720
Extracting features from sample 1330/1720
Extracting features from sample 1331/1720
Extracting features from sample 1332/1720
Extracting features from sample 1333/1720
Extracting features from sample 1334/1720
Extracting features from sample 1335/1720
Extracting features from sample 1336/1720
Extracting features from sample 1337/1720
Extracting features from sample 1338/1720
Extracting features from sample 1339/1720
Extracting features from sample 1340/1720
Extracting features from sample 1341/1720
Extracting features from sample 1342/1720
Extracting features from sample 1343/1720
Extracting features from sample 1344/1720
Extracting features from sample 1345/1720
Extracting features from sample 1346/1720
Extracting features from sample 1347/1720
Extracting features from sample 1348/1720
Extracting features from sample 1349/1720
Extracting features from sample 1350/1720
Extracting features from sample 1351/1720
Extracting features from sample 1352/1720
Extracting features from sample 1353/1720
Extracting features from sample 1354/1720
Extracting features from sample 1355/1720
Extracting features from sample 1356/1720
Extracting features from sample 1357/1720
Extracting features from sample 1358/1720
Extracting features from sample 1359/1720
Extracting features from sample 1360/1720
Extracting features from sample 1361/1720
Extracting features from sample 1362/1720
Extracting features from sample 1363/1720
Extracting features from sample 1364/1720
Extracting features from sample 1365/1720
Extracting features from sample 1366/1720
Extracting features from sample 1367/1720
Extracting features from sample 1368/1720
Extracting features from sample 1369/1720
Extracting features from sample 1370/1720
Extracting features from sample 1371/1720
Extracting features from sample 1372/1720
Extracting features from sample 1373/1720
Extracting features from sample 1374/1720
Extracting features from sample 1375/1720
Extracting features from sample 1376/1720
Extracting features from sample 1377/1720
Extracting features from sample 1378/1720
Extracting features from sample 1379/1720
Extracting features from sample 1380/1720
Extracting features from sample 1381/1720
Extracting features from sample 1382/1720
Extracting features from sample 1383/1720
Extracting features from sample 1384/1720
Extracting features from sample 1385/1720
Extracting features from sample 1386/1720
Extracting features from sample 1387/1720
Extracting features from sample 1388/1720
Extracting features from sample 1389/1720
Extracting features from sample 1390/1720
Extracting features from sample 1391/1720
Extracting features from sample 1392/1720
Extracting features from sample 1393/1720
Extracting features from sample 1394/1720
Extracting features from sample 1395/1720
Extracting features from sample 1396/1720
Extracting features from sample 1397/1720
Extracting features from sample 1398/1720
Extracting features from sample 1399/1720
Extracting features from sample 1400/1720
Extracting features from sample 1401/1720
Extracting features from sample 1402/1720
Extracting features from sample 1403/1720
Extracting features from sample 1404/1720
Extracting features from sample 1405/1720
Extracting features from sample 1406/1720
Extracting features from sample 1407/1720
Extracting features from sample 1408/1720
Extracting features from sample 1409/1720
Extracting features from sample 1410/1720
Extracting features from sample 1411/1720
Extracting features from sample 1412/1720
Extracting features from sample 1413/1720
Extracting features from sample 1414/1720
Extracting features from sample 1415/1720
Extracting features from sample 1416/1720
Extracting features from sample 1417/1720
Extracting features from sample 1418/1720
Extracting features from sample 1419/1720
Extracting features from sample 1420/1720
Extracting features from sample 1421/1720
Extracting features from sample 1422/1720
Extracting features from sample 1423/1720
Extracting features from sample 1424/1720
Extracting features from sample 1425/1720
Extracting features from sample 1426/1720
Extracting features from sample 1427/1720
Extracting features from sample 1428/1720
Extracting features from sample 1429/1720
Extracting features from sample 1430/1720
Extracting features from sample 1431/1720
Extracting features from sample 1432/1720
Extracting features from sample 1433/1720
Extracting features from sample 1434/1720
Extracting features from sample 1435/1720
Extracting features from sample 1436/1720
Extracting features from sample 1437/1720
Extracting features from sample 1438/1720
Extracting features from sample 1439/1720
Extracting features from sample 1440/1720
Extracting features from sample 1441/1720
Extracting features from sample 1442/1720
Extracting features from sample 1443/1720
Extracting features from sample 1444/1720
Extracting features from sample 1445/1720
Extracting features from sample 1446/1720
Extracting features from sample 1447/1720
Extracting features from sample 1448/1720
Extracting features from sample 1449/1720
Extracting features from sample 1450/1720
Extracting features from sample 1451/1720
Extracting features from sample 1452/1720
Extracting features from sample 1453/1720
Extracting features from sample 1454/1720
Extracting features from sample 1455/1720
Extracting features from sample 1456/1720
Extracting features from sample 1457/1720
Extracting features from sample 1458/1720
Extracting features from sample 1459/1720
Extracting features from sample 1460/1720
Extracting features from sample 1461/1720
Extracting features from sample 1462/1720
Extracting features from sample 1463/1720
Extracting features from sample 1464/1720
Extracting features from sample 1465/1720
Extracting features from sample 1466/1720
Extracting features from sample 1467/1720
Extracting features from sample 1468/1720
Extracting features from sample 1469/1720
Extracting features from sample 1470/1720
Extracting features from sample 1471/1720
Extracting features from sample 1472/1720
Extracting features from sample 1473/1720
Extracting features from sample 1474/1720
Extracting features from sample 1475/1720
Extracting features from sample 1476/1720
Extracting features from sample 1477/1720
Extracting features from sample 1478/1720
Extracting features from sample 1479/1720
Extracting features from sample 1480/1720
Extracting features from sample 1481/1720
Extracting features from sample 1482/1720
Extracting features from sample 1483/1720
Extracting features from sample 1484/1720
Extracting features from sample 1485/1720
Extracting features from sample 1486/1720
Extracting features from sample 1487/1720
Extracting features from sample 1488/1720
Extracting features from sample 1489/1720
Extracting features from sample 1490/1720
Extracting features from sample 1491/1720
Extracting features from sample 1492/1720
Extracting features from sample 1493/1720
Extracting features from sample 1494/1720
Extracting features from sample 1495/1720
Extracting features from sample 1496/1720
Extracting features from sample 1497/1720
Extracting features from sample 1498/1720
Extracting features from sample 1499/1720
Extracting features from sample 1500/1720
Extracting features from sample 1501/1720
Extracting features from sample 1502/1720
Extracting features from sample 1503/1720
Extracting features from sample 1504/1720
Extracting features from sample 1505/1720
Extracting features from sample 1506/1720
Extracting features from sample 1507/1720
Extracting features from sample 1508/1720
Extracting features from sample 1509/1720
Extracting features from sample 1510/1720
Extracting features from sample 1511/1720
Extracting features from sample 1512/1720
Extracting features from sample 1513/1720
Extracting features from sample 1514/1720
Extracting features from sample 1515/1720
Extracting features from sample 1516/1720
Extracting features from sample 1517/1720
Extracting features from sample 1518/1720
Extracting features from sample 1519/1720
Extracting features from sample 1520/1720
Extracting features from sample 1521/1720
Extracting features from sample 1522/1720
Extracting features from sample 1523/1720
Extracting features from sample 1524/1720
Extracting features from sample 1525/1720
Extracting features from sample 1526/1720
Extracting features from sample 1527/1720
Extracting features from sample 1528/1720
Extracting features from sample 1529/1720
Extracting features from sample 1530/1720
Extracting features from sample 1531/1720
Extracting features from sample 1532/1720
Extracting features from sample 1533/1720
Extracting features from sample 1534/1720
Extracting features from sample 1535/1720
Extracting features from sample 1536/1720
Extracting features from sample 1537/1720
Extracting features from sample 1538/1720
Extracting features from sample 1539/1720
Extracting features from sample 1540/1720
Extracting features from sample 1541/1720
Extracting features from sample 1542/1720
Extracting features from sample 1543/1720
Extracting features from sample 1544/1720
Extracting features from sample 1545/1720
Extracting features from sample 1546/1720
Extracting features from sample 1547/1720
Extracting features from sample 1548/1720
Extracting features from sample 1549/1720
Extracting features from sample 1550/1720
Extracting features from sample 1551/1720
Extracting features from sample 1552/1720
Extracting features from sample 1553/1720
Extracting features from sample 1554/1720
Extracting features from sample 1555/1720
Extracting features from sample 1556/1720
Extracting features from sample 1557/1720
Extracting features from sample 1558/1720
Extracting features from sample 1559/1720
Extracting features from sample 1560/1720
Extracting features from sample 1561/1720
Extracting features from sample 1562/1720
Extracting features from sample 1563/1720
Extracting features from sample 1564/1720
Extracting features from sample 1565/1720
Extracting features from sample 1566/1720
Extracting features from sample 1567/1720
Extracting features from sample 1568/1720
Extracting features from sample 1569/1720
Extracting features from sample 1570/1720
Extracting features from sample 1571/1720
Extracting features from sample 1572/1720
Extracting features from sample 1573/1720
Extracting features from sample 1574/1720
Extracting features from sample 1575/1720
Extracting features from sample 1576/1720
Extracting features from sample 1577/1720
Extracting features from sample 1578/1720
Extracting features from sample 1579/1720
Extracting features from sample 1580/1720
Extracting features from sample 1581/1720
Extracting features from sample 1582/1720
Extracting features from sample 1583/1720
Extracting features from sample 1584/1720
Extracting features from sample 1585/1720
Extracting features from sample 1586/1720
Extracting features from sample 1587/1720
Extracting features from sample 1588/1720
Extracting features from sample 1589/1720
Extracting features from sample 1590/1720
Extracting features from sample 1591/1720
Extracting features from sample 1592/1720
Extracting features from sample 1593/1720
Extracting features from sample 1594/1720
Extracting features from sample 1595/1720
Extracting features from sample 1596/1720
Extracting features from sample 1597/1720
Extracting features from sample 1598/1720
Extracting features from sample 1599/1720
Extracting features from sample 1600/1720
Extracting features from sample 1601/1720
Extracting features from sample 1602/1720
Extracting features from sample 1603/1720
Extracting features from sample 1604/1720
Extracting features from sample 1605/1720
Extracting features from sample 1606/1720
Extracting features from sample 1607/1720
Extracting features from sample 1608/1720
Extracting features from sample 1609/1720
Extracting features from sample 1610/1720
Extracting features from sample 1611/1720
Extracting features from sample 1612/1720
Extracting features from sample 1613/1720
Extracting features from sample 1614/1720
Extracting features from sample 1615/1720
Extracting features from sample 1616/1720
Extracting features from sample 1617/1720
Extracting features from sample 1618/1720
Extracting features from sample 1619/1720
Extracting features from sample 1620/1720
Extracting features from sample 1621/1720
Extracting features from sample 1622/1720
Extracting features from sample 1623/1720
Extracting features from sample 1624/1720
Extracting features from sample 1625/1720
Extracting features from sample 1626/1720
Extracting features from sample 1627/1720
Extracting features from sample 1628/1720
Extracting features from sample 1629/1720
Extracting features from sample 1630/1720
Extracting features from sample 1631/1720
Extracting features from sample 1632/1720
Extracting features from sample 1633/1720
Extracting features from sample 1634/1720
Extracting features from sample 1635/1720
Extracting features from sample 1636/1720
Extracting features from sample 1637/1720
Extracting features from sample 1638/1720
Extracting features from sample 1639/1720
Extracting features from sample 1640/1720
Extracting features from sample 1641/1720
Extracting features from sample 1642/1720
Extracting features from sample 1643/1720
Extracting features from sample 1644/1720
Extracting features from sample 1645/1720
Extracting features from sample 1646/1720
Extracting features from sample 1647/1720
Extracting features from sample 1648/1720
Extracting features from sample 1649/1720
Extracting features from sample 1650/1720
Extracting features from sample 1651/1720
Extracting features from sample 1652/1720
Extracting features from sample 1653/1720
Extracting features from sample 1654/1720
Extracting features from sample 1655/1720
Extracting features from sample 1656/1720
Extracting features from sample 1657/1720
Extracting features from sample 1658/1720
Extracting features from sample 1659/1720
Extracting features from sample 1660/1720
Extracting features from sample 1661/1720
Extracting features from sample 1662/1720
Extracting features from sample 1663/1720
Extracting features from sample 1664/1720
Extracting features from sample 1665/1720
Extracting features from sample 1666/1720
Extracting features from sample 1667/1720
Extracting features from sample 1668/1720
Extracting features from sample 1669/1720
Extracting features from sample 1670/1720
Extracting features from sample 1671/1720
Extracting features from sample 1672/1720
Extracting features from sample 1673/1720
Extracting features from sample 1674/1720
Extracting features from sample 1675/1720
Extracting features from sample 1676/1720
Extracting features from sample 1677/1720
Extracting features from sample 1678/1720
Extracting features from sample 1679/1720
Extracting features from sample 1680/1720
Extracting features from sample 1681/1720
Extracting features from sample 1682/1720
Extracting features from sample 1683/1720
Extracting features from sample 1684/1720
Extracting features from sample 1685/1720
Extracting features from sample 1686/1720
Extracting features from sample 1687/1720
Extracting features from sample 1688/1720
Extracting features from sample 1689/1720
Extracting features from sample 1690/1720
Extracting features from sample 1691/1720
Extracting features from sample 1692/1720
Extracting features from sample 1693/1720
Extracting features from sample 1694/1720
Extracting features from sample 1695/1720
Extracting features from sample 1696/1720
Extracting features from sample 1697/1720
Extracting features from sample 1698/1720
Extracting features from sample 1699/1720
Extracting features from sample 1700/1720
Extracting features from sample 1701/1720
Extracting features from sample 1702/1720
Extracting features from sample 1703/1720
Extracting features from sample 1704/1720
Extracting features from sample 1705/1720
Extracting features from sample 1706/1720
Extracting features from sample 1707/1720
Extracting features from sample 1708/1720
Extracting features from sample 1709/1720
Extracting features from sample 1710/1720
Extracting features from sample 1711/1720
Extracting features from sample 1712/1720
Extracting features from sample 1713/1720
Extracting features from sample 1714/1720
Extracting features from sample 1715/1720
Extracting features from sample 1716/1720
Extracting features from sample 1717/1720
Extracting features from sample 1718/1720
Extracting features from sample 1719/1720
Time taken to calculate features: 1115.64 seconds
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Absolute energy</th>
      <th>Area under the curve</th>
      <th>Autocorrelation</th>
      <th>Average power</th>
      <th>Centroid</th>
      <th>ECDF Percentile Count_0</th>
      <th>ECDF Percentile Count_1</th>
      <th>ECDF Percentile_0</th>
      <th>ECDF Percentile_1</th>
      <th>ECDF_0</th>
      <th>...</th>
      <th>Wavelet variance_1</th>
      <th>Wavelet variance_2</th>
      <th>Wavelet variance_3</th>
      <th>Wavelet variance_4</th>
      <th>Wavelet variance_5</th>
      <th>Wavelet variance_6</th>
      <th>Wavelet variance_7</th>
      <th>Wavelet variance_8</th>
      <th>Zero crossing rate</th>
      <th>source_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000067</td>
      <td>...</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
      <td>surface_event</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.325603e+09</td>
      <td>5.627850e+04</td>
      <td>2.325603e+09</td>
      <td>1.550402e+07</td>
      <td>76.418530</td>
      <td>3000.0</td>
      <td>12000.0</td>
      <td>292.999790</td>
      <td>450.250905</td>
      <td>0.000067</td>
      <td>...</td>
      <td>6.678689e+02</td>
      <td>1.055538e+03</td>
      <td>2.530908e+03</td>
      <td>5.790352e+03</td>
      <td>1.165462e+04</td>
      <td>2.118641e+04</td>
      <td>3.548474e+04</td>
      <td>5.549514e+04</td>
      <td>28.0</td>
      <td>surface_event</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8.705101e+11</td>
      <td>7.477590e+05</td>
      <td>8.705101e+11</td>
      <td>5.803400e+09</td>
      <td>74.967691</td>
      <td>3000.0</td>
      <td>12000.0</td>
      <td>2434.988468</td>
      <td>5493.021391</td>
      <td>0.000067</td>
      <td>...</td>
      <td>9.263918e+07</td>
      <td>2.386667e+08</td>
      <td>2.936940e+08</td>
      <td>2.466776e+08</td>
      <td>1.717919e+08</td>
      <td>1.109657e+08</td>
      <td>6.954319e+07</td>
      <td>4.344068e+07</td>
      <td>258.0</td>
      <td>surface_event</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9.606099e+11</td>
      <td>1.168706e+06</td>
      <td>9.606099e+11</td>
      <td>6.404066e+09</td>
      <td>74.660640</td>
      <td>3000.0</td>
      <td>12000.0</td>
      <td>-9228.169002</td>
      <td>-6414.699254</td>
      <td>0.000067</td>
      <td>...</td>
      <td>2.431281e+06</td>
      <td>7.334504e+06</td>
      <td>1.268369e+07</td>
      <td>1.649068e+07</td>
      <td>1.778231e+07</td>
      <td>1.683463e+07</td>
      <td>1.469724e+07</td>
      <td>1.235497e+07</td>
      <td>16.0</td>
      <td>surface_event</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.595338e+11</td>
      <td>7.343233e+05</td>
      <td>3.595338e+11</td>
      <td>2.396892e+09</td>
      <td>74.976185</td>
      <td>3000.0</td>
      <td>12000.0</td>
      <td>-4927.503218</td>
      <td>-4863.251218</td>
      <td>0.000067</td>
      <td>...</td>
      <td>4.896885e+03</td>
      <td>1.023186e+04</td>
      <td>1.774939e+04</td>
      <td>2.750474e+04</td>
      <td>3.936635e+04</td>
      <td>5.330725e+04</td>
      <td>6.934682e+04</td>
      <td>8.750847e+04</td>
      <td>0.0</td>
      <td>surface_event</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 390 columns</p>
</div></div></div>
</div>
<section id="new-dataframe-clean-up">
<h3>New DataFrame Clean up<a class="headerlink" href="#new-dataframe-clean-up" title="Permalink to this headline">#</a></h3>
<p>Removing the samples with NaN or Infinity</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;no of samples in the dataframe:</span><span class="si">{</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="c1"># Replace infinities with NaN</span>
<span class="n">new_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

<span class="c1"># Drop rows with NaN values</span>
<span class="n">new_X</span> <span class="o">=</span> <span class="n">new_X</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;no of samples in the new dataframe:</span><span class="si">{</span><span class="n">new_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>no of samples in the dataframe:1720
no of samples in the new dataframe:1717
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Absolute energy</th>
      <th>Area under the curve</th>
      <th>Autocorrelation</th>
      <th>Average power</th>
      <th>Centroid</th>
      <th>ECDF Percentile Count_0</th>
      <th>ECDF Percentile Count_1</th>
      <th>ECDF Percentile_0</th>
      <th>ECDF Percentile_1</th>
      <th>ECDF_0</th>
      <th>...</th>
      <th>Wavelet variance_1</th>
      <th>Wavelet variance_2</th>
      <th>Wavelet variance_3</th>
      <th>Wavelet variance_4</th>
      <th>Wavelet variance_5</th>
      <th>Wavelet variance_6</th>
      <th>Wavelet variance_7</th>
      <th>Wavelet variance_8</th>
      <th>Zero crossing rate</th>
      <th>source_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000067</td>
      <td>...</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
      <td>surface_event</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.325603e+09</td>
      <td>5.627850e+04</td>
      <td>2.325603e+09</td>
      <td>1.550402e+07</td>
      <td>76.418530</td>
      <td>3000.0</td>
      <td>12000.0</td>
      <td>292.999790</td>
      <td>450.250905</td>
      <td>0.000067</td>
      <td>...</td>
      <td>6.678689e+02</td>
      <td>1.055538e+03</td>
      <td>2.530908e+03</td>
      <td>5.790352e+03</td>
      <td>1.165462e+04</td>
      <td>2.118641e+04</td>
      <td>3.548474e+04</td>
      <td>5.549514e+04</td>
      <td>28.0</td>
      <td>surface_event</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8.705101e+11</td>
      <td>7.477590e+05</td>
      <td>8.705101e+11</td>
      <td>5.803400e+09</td>
      <td>74.967691</td>
      <td>3000.0</td>
      <td>12000.0</td>
      <td>2434.988468</td>
      <td>5493.021391</td>
      <td>0.000067</td>
      <td>...</td>
      <td>9.263918e+07</td>
      <td>2.386667e+08</td>
      <td>2.936940e+08</td>
      <td>2.466776e+08</td>
      <td>1.717919e+08</td>
      <td>1.109657e+08</td>
      <td>6.954319e+07</td>
      <td>4.344068e+07</td>
      <td>258.0</td>
      <td>surface_event</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9.606099e+11</td>
      <td>1.168706e+06</td>
      <td>9.606099e+11</td>
      <td>6.404066e+09</td>
      <td>74.660640</td>
      <td>3000.0</td>
      <td>12000.0</td>
      <td>-9228.169002</td>
      <td>-6414.699254</td>
      <td>0.000067</td>
      <td>...</td>
      <td>2.431281e+06</td>
      <td>7.334504e+06</td>
      <td>1.268369e+07</td>
      <td>1.649068e+07</td>
      <td>1.778231e+07</td>
      <td>1.683463e+07</td>
      <td>1.469724e+07</td>
      <td>1.235497e+07</td>
      <td>16.0</td>
      <td>surface_event</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.595338e+11</td>
      <td>7.343233e+05</td>
      <td>3.595338e+11</td>
      <td>2.396892e+09</td>
      <td>74.976185</td>
      <td>3000.0</td>
      <td>12000.0</td>
      <td>-4927.503218</td>
      <td>-4863.251218</td>
      <td>0.000067</td>
      <td>...</td>
      <td>4.896885e+03</td>
      <td>1.023186e+04</td>
      <td>1.774939e+04</td>
      <td>2.750474e+04</td>
      <td>3.936635e+04</td>
      <td>5.330725e+04</td>
      <td>6.934682e+04</td>
      <td>8.750847e+04</td>
      <td>0.0</td>
      <td>surface_event</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 390 columns</p>
</div></div></div>
</div>
</section>
</section>
<section id="explore-correlation-among-features">
<h2>Explore correlation  among features<a class="headerlink" href="#explore-correlation-among-features" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Compute pairwise correlation of columns</span>
<span class="n">corr_matrix</span> <span class="o">=</span> <span class="n">new_X</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;source_type&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>

<span class="c1"># Create a mask to only show the lower triangle of the matrix (since it&#39;s mirrored around its </span>
<span class="c1"># top-left to bottom-right diagonal)</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">corr_matrix</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">))</span>

<span class="c1"># Draw the heatmap with the mask</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr_matrix</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> 
            <span class="c1">#cbar_kws={&quot;shrink&quot;: .5}, </span>
            <span class="n">annot</span><span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2.11_feature_engineering_56_0.png" src="../_images/2.11_feature_engineering_56_0.png" />
</div>
</div>
</section>
<section id="exploring-the-feature-space-for-classification-purpose">
<h2>Exploring the feature space for classification purpose<a class="headerlink" href="#exploring-the-feature-space-for-classification-purpose" title="Permalink to this headline">#</a></h2>
<p>Here we will plot distributions of certain features among the four classes. And we will explore what features are most correlated with each others in each of the categories.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_feature_histograms</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="n">feature</span><span class="p">):</span>
    <span class="c1"># Get unique source types</span>
    <span class="n">source_types</span> <span class="o">=</span> <span class="n">new_X</span><span class="p">[</span><span class="s1">&#39;source_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

    <span class="c1"># Define colorblind-friendly palette</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;colorblind&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">source_type</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">source_types</span><span class="p">):</span>
        <span class="c1"># Select data for this source type</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">new_X</span><span class="p">[</span><span class="n">new_X</span><span class="p">[</span><span class="s1">&#39;source_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">source_type</span><span class="p">][</span><span class="n">feature</span><span class="p">]</span>
        
        <span class="c1"># Plot histogram for this source type</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">source_type</span><span class="p">)</span>

    <span class="c1"># Add title</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;np.log10(</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    
    <span class="c1"># Add x-axis label</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;np.log10(</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    
    <span class="c1"># Add y-axis label</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
    
    <span class="c1"># Add legend</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># Show plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">feature</span> <span class="o">=</span> <span class="s1">&#39;Area under the curve&#39;</span>
<span class="n">plot_feature_histograms</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="n">feature</span><span class="p">)</span>

<span class="n">feature</span> <span class="o">=</span> <span class="s1">&#39;Kurtosis&#39;</span>
<span class="n">plot_feature_histograms</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="n">feature</span><span class="p">)</span>

<span class="n">feature</span> <span class="o">=</span> <span class="s1">&#39;Spectral variation&#39;</span>
<span class="n">plot_feature_histograms</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="n">feature</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2.11_feature_engineering_59_0.png" src="../_images/2.11_feature_engineering_59_0.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/marinedenolle/opt/miniconda3/envs/mlgeo/lib/python3.9/site-packages/pandas/core/arraylike.py:396: RuntimeWarning: invalid value encountered in log10
  result = getattr(ufunc, method)(*inputs, **kwargs)
</pre></div>
</div>
<img alt="../_images/2.11_feature_engineering_59_2.png" src="../_images/2.11_feature_engineering_59_2.png" />
<img alt="../_images/2.11_feature_engineering_59_3.png" src="../_images/2.11_feature_engineering_59_3.png" />
</div>
</div>
<section id="student-exercise">
<h3>Student exercise<a class="headerlink" href="#student-exercise" title="Permalink to this headline">#</a></h3>
<ol class="simple">
<li><p>Which of the features will be best to classify among the event type classes?</p></li>
</ol>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Chapter2-DataManipulation"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="2.10_synthetic_noise.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">2.10 Synthetic noise</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="2.12_dimensionality_reduction.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">2.12 Dimensionality Reduction</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By eScience Institute, University of Washington<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>